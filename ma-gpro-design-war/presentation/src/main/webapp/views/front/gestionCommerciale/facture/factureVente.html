<script type="text/javascript">
  var CommandBarElements = document.querySelectorAll(".ms-CommandBar");
  for (var i = 0; i < CommandBarElements.length; i++) {
    new fabric['CommandBar'](CommandBarElements[i]);
  }

  var SearchBoxElements = document.querySelectorAll(".ms-SearchBox");
  for (var i = 0; i < SearchBoxElements.length; i++) {
    new fabric['SearchBox'](SearchBoxElements[i]);
  }

</script>





<div class="container-fluid" ng-controller="factureVenteController" style="background-color: #fff;">

  <div class="row" ng-show="traitementEnCoursGenererAll =='true'">
    <div class="col-sm-5"></div>
    <div class="col-sm-2">
      <br>
      <div ng-click="traitementEnCoursGenererAll ='false'">


        <div class="lds-ellipsis">
          <div></div>
          <div></div>
          <div></div>
          <div></div>
        </div>




      </div>

    </div>
    <div class="col-sm-5"></div>

  </div>

  <div class="row" ng-show="traitementEnCours=='true'" ng-click="traitementEnCours ='false'">
    <div class="col-sm-5"></div>
    <div class="col-sm-2">
      <br>
      <div>
        <div>

          <div class="lds-spinner">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
        </div>
        <div></div>
        <div>{{msg}}</div>


      </div>

    </div>
    <div class="col-sm-5"></div>

  </div>


  <div class="row" ng-hide="hiddenNotif">

    <div class="col-sm-8"></div>
    <div class="col-sm-4">
      <br> <span>
        <alert type="success" class="alert-success-sauvegarde light"
          style="text-align: center !important; background-color: #1BC5BD !important">
          <span ng-bind-html="'Facture Vente enregistr&eacute;e avec succ&egrave;s.' | safe_html"></span>
          <a> <i class="fa fa-times close-notif" ng-click="closeNotif()" style="color: #fff !important;"></i>
          </a>
        </alert>
      </span>
    </div>
  </div>

  <div class="row" ng-show="displayMode != 'edit'">
    <div class="col-sm-12">
      <br />
      <span class="ms-ListItem-primaryText">Facture</span>
      <br />

      <div class="ms-CommandBar ms-CommandBar--navBar">
        <div class="ms-CommandBar-sideCommands">
          <div class="ms-CommandButton ms-CommandButton--noLabel">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon ms-fontColor-themePrimary"><i class="ms-Icon ms-Icon--Info"></i></span>
              <span class="ms-CommandButton-label"></span>
            </button>
          </div>
        </div>
        <div class="ms-CommandBar-mainArea">
          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="affectationBLVente(factureVenteCourant)">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--CirclePlus"></i></span>
              <span class="ms-CommandButton-label">Ajouter</span>
            </button>
          </div>



          <div class="ms-CommandButton ms-CommandButton--drop">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon ms-fontColor-themePrimary"><i
                  class="ms-Icon ms-Icon--Generate"></i></span>
              <span class="ms-CommandButton-label">G&eacute;n&eacute;rer</span>
              <span class="ms-CommandButton-dropdownIcon"><i class="ms-Icon ms-Icon--ChevronDown"></i></span>
            </button>
            <ul class="ms-ContextualMenu is-opened ms-ContextualMenu--hasIcons">
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1"
                  ng-click="downloadAllFactures(factureVenteCourant,2)">PDF</a>

              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1"
                  ng-click="downloadAllFacturesExcel(factureVenteCourant,2)">EXCEL</a>

              </li>

              <!-- 		<li class="ms-ContextualMenu-item">
										<a class="ms-ContextualMenu-link" tabindex="1"
										  ng-click="downloadAllFacturesExcelDevise(factureVenteCourant,2)">EXCEL avec devise</a>
						
									  </li> -->
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1"
                  ng-click="downloadRecapExcel(factureVenteCourant,2)">Recap</a>

              </li>
            </ul>
          </div>

          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="rechercherFactureVente(factureVenteCourant)">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--FolderSearch"></i></span>
              <span class="ms-CommandButton-label">Rechercher</span>
            </button>
          </div>

          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="annulerAjout()">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--Cancel"></i></span>
              <span class="ms-CommandButton-label">Annuler</span>
            </button>
          </div>
          <div class="ms-CommandButton ms-CommandBar-overflowButton ms-CommandButton--noLabel">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--More"></i></span>
              <span class="ms-CommandButton-label"></span>
            </button>
            <ul class="ms-ContextualMenu is-opened">
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Folder</a>
                <i class="ms-Icon ms-Icon--Folder"></i>
              </li>
              <li class="ms-ContextualMenu-item ms-ContextualMenu-item--divider"></li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Plain Text Document</a>
                <i class="ms-Icon ms-Icon--Document"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">A Coffee</a>
                <i class="ms-Icon ms-Icon--Coffee"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Picture</a>
                <i class="ms-Icon ms-Icon--Picture"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Money</a>
                <i class="ms-Icon ms-Icon--Money"></i>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="panel panel-primary">
        <div class="panel-body">
          <form class="form-horizontal" name="rechercheFactureVenteForm" id="rechercheFactureVenteForm">
            <!--  <div class="row" ng-hide="hiddenNotif">
              <div class="col-sm-8">
              </div>
              <div class="col-sm-4">


                <span>
                  <alert type="success" class="alert-success-sauvegarde light"
                    style="text-align: center !important; background-color: #1BC5BD !important"> <span
                      ng-bind-html="'Facture enregistrer avec succ&egrave;s.' | safe_html"></span>
                    <a> <i class="fa fa-times close-notif" ng-click="closeNotif()" style="color: #fff !important;"></i>
                    </a> </alert>
                </span>

              </div>
            </div> -->

            <div class="row">
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f.Facture</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.referenceFacture =''"
                      ng-model="factureVenteCourant.referenceFacture" />
                  </div>
                </div>
              </div>
              <div class="col-sm-3">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Client</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.partieIntId" data-placeholder=""
                      class="form-control" style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous les Clients</option>
                      <option ng-repeat="client in listePartieInteresseeCache | filter:{famillePartieInteressee:1}"
                        value="{{client.id}}">{{client.reference}}-{{client.abreviation}}</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f.BL</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.referenceBl =''"
                      ng-model="factureVenteCourant.referenceBl" />
                  </div>
                </div>
              </div>
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f.BL Externe</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.referenceBlExterne =''"
                      ng-model="factureVenteCourant.referenceBlExterne" />
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-3" ng-controller="DatepickerDemoController">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text ms-Label"> Date Fac.Entree</span>
                    </div>
                    <input type="text" class="form-control datepicker" datepicker-popup="{{format}}"
                      ng-init="factureVenteCourant.dateFactureMin =''" ng-model="factureVenteCourant.dateFactureMin"
                      is-open="opened" datepicker-options="dateOptions" date-disabled="enabled(date, mode)"
                      ng-required="false" close-text="Close" />

                    <div class="input-group-append">
                      <button type="button" class="btn1 btn-default" ng-click="open($event)" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        ">
                        <i class="glyphicon glyphicon-calendar" style="color: #3699ff;"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-3" ng-controller="DatepickerDemoController">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text ms-Label"> ET</span>
                    </div>
                    <input type="text" class="form-control datepicker" datepicker-popup="{{format}}"
                      ng-init="factureVenteCourant.dateFactureMax =''" ng-model="factureVenteCourant.dateFactureMax"
                      is-open="opened" datepicker-options="dateOptions" date-disabled="enabled(date, mode)"
                      ng-required="false" close-text="Close" />

                    <div class="input-group-append">
                      <button type="button" class="btn1 btn-default" ng-click="open($event)" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        ">
                        <i class="glyphicon glyphicon-calendar" style="color: #3699ff;"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Prix Entre</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.prixMin =''"
                      ng-model="factureVenteCourant.prixMin" type="number" min="0" pattern="^\d*(\.\d{0,2})?$"
                      placeholder="0.00" value="0" name="prixMin" />
                  </div>
                  <div ng-show="
                  rechercheFactureVenteForm.prixMin.$dirty && rechercheFactureVenteForm.prixMin.$invalid"
                    class="error">
                    <div ng-show="rechercheFactureVenteForm.prixMin.$error">
                      La valeur doit être supérieure ou égale à 0 !
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">ET</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.prixMax =''"
                      ng-model="factureVenteCourant.prixMax" type="number" min="0" pattern="^\d*(\.\d{0,2})?$"
                      placeholder="0.00" value="0" name="prixMax" />
                  </div>
                  <div ng-show="
                  rechercheFactureVenteForm.prixMax.$dirty && rechercheFactureVenteForm.prixMax.$invalid"
                    class="error">
                    <div ng-show="rechercheFactureVenteForm.prixMax.$error">
                      La valeur doit être supérieure ou égale à 0 !
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Groupe</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.groupeClientId"
                      ng-init="factureVenteCourant.groupeClientId =''" data-placeholder="..." class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous</option>
                      <option ng-repeat="groupe in listGroupeClient" value="{{groupe.id}}">{{groupe.designation}}
                      </option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">March&eacute;</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.marcheId"
                      ng-init="factureVenteCourant.marcheId =''" data-placeholder="" class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous les March&eacute;s</option>
                      <option ng-repeat="marche in bllisteMarche" value="{{marche.id}}">{{marche.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Quantit&eacute; Entre</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.metrageMin =''"
                      ng-model="factureVenteCourant.metrageMin" type="number" min="0" pattern="^\d*(\.\d{0,2})?$"
                      placeholder="0" value="0" name="metrageMin" />
                  </div>

                  <div ng-show="
                  rechercheFactureVenteForm.metrageMin.$dirty && rechercheFactureVenteForm.metrageMin.$invalid"
                    class="error">
                    <div ng-show="rechercheFactureVenteForm.metrageMin.$error">
                      La valeur doit être supérieure ou égale à 0 !
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">ET</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.metrageMax =''"
                      ng-model="factureVenteCourant.metrageMax" type="number" min="0" pattern="^\d*(\.\d{0,2})?$"
                      placeholder="0" value="0" name="metrageMax" />
                  </div>
                  <div ng-show="
                  rechercheFactureVenteForm.metrageMax.$dirty && rechercheFactureVenteForm.metrageMax.$invalid"
                    class="error">
                    <div ng-show="rechercheFactureVenteForm.metrageMax.$error">
                      La valeur doit être supérieure ou égale à 0 !
                    </div>
                  </div>
                </div>
              </div>
            </div>


            <div class="row">
            
            
               <div class="col-sm-4">
                 <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f.Commande</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.refCommande =''"
                      ng-model="factureVenteCourant.refCommande"
                      />
                  </div>
                </div>
              </div>
            
            
            
            
                     <div class="col-sm-3">
                 <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Identifiant</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.identifiant =''"
                      ng-model="factureVenteCourant.identifiant"
                      />
                  </div>
                </div>
              </div>
              
            
            
            
            
              <div class="col-sm-3">
                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text">Devise </span>
                    </div>
                    <select ui-select2="true" class="form-control" ng-model="factureVenteCourant.devise"
                      ng-init="factureVenteCourant.devise=''">
                      <option value="">Tous</option>
                      <option ng-repeat="dev in ListeDevise" value="{{dev.id}}">
                        {{dev.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="col-sm-3" ng-show="clientActif.blackMode==true">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Declaree</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.declarerecherche" data-placeholder=""
                      class="form-control" style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous</option>
                      <option value="oui">OUI</option>
                      <option value="non">NON</option>
                    </select>
                  </div>
                </div>
              </div>
              
              
                <div class="col-sm-3">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Forcer calcul montant</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.forcerCalculMontantRech" data-placeholder=""
                      class="form-control" style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous</option>
                      <option value="oui">OUI</option>
                      <option value="non">NON</option>
                    </select>
                  </div>
                </div>
              </div>


            </div>
            
            
            
            
               <div class="row">
               <div class="col-sm-4" ng-controller="DatepickerDemoController">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text ms-Label"> Date Echeance De</span>
                    </div>
                    <input type="text" class="form-control datepicker" datepicker-popup="{{format}}"
                      ng-model="factureVenteCourant.dateEcheanceDe" is-open="opened" datepicker-options="dateOptions"
                      date-disabled="enabled(date, mode)" close-text="Close" />

                    <div class="input-group-append">
                      <button type="button" class="btn1 btn-default" ng-click="open($event)" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        ">
                        <i class="glyphicon glyphicon-calendar" style="color: #3699ff;"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              
              
              
              
              
                         <div class="col-sm-4" ng-controller="DatepickerDemoController">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text ms-Label"> Date Echeance A</span>
                    </div>
                    <input type="text" class="form-control datepicker" datepicker-popup="{{format}}"
                      ng-model="factureVenteCourant.dateEcheanceA" is-open="opened" datepicker-options="dateOptions"
                      date-disabled="enabled(date, mode)" close-text="Close" />

                    <div class="input-group-append">
                      <button type="button" class="btn1 btn-default" ng-click="open($event)" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        ">
                        <i class="glyphicon glyphicon-calendar" style="color: #3699ff;"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            
                 </div>
            
            



          </form>
        </div>
      </div>
    </div>
  </div>


  <div class="row" ng-show="displayMode == 'edit'">
    <div class="col-sm-12">
      <div class="pull-right">


        <br />
        <div class="row">
          <div class="col-sm-12" ng-show="hiddenNotifSucc">
            <div class="ms-MessageBar ms-MessageBar--error mx-auto float-left" style="width: 300px !important;">
              <div class="ms-MessageBar-content">
                <div class="ms-MessageBar-icon">
                  <i class="ms-Icon ms-Icon--ErrorBadge"></i>
                </div>
                <div class="ms-MessageBar-text">
                  <b>Facture existe d&egrave;ja </b>
                  <br />
                </div>
              </div>
            </div>
          </div>
        </div>
        <br />

        <!-- <div class="btn btn-outline-info" ng-show="traitementEnCours=='true'" ng-click="traitementEnCours ='false'">
          <div>
            <div class="lds-spinner">
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
            </div>
          </div>
          <div></div>
          <div>{{msg}}</div>
        </div> -->

        <button type="warninig" ng-show="refBLIsInvalid" class="alert-warning" ng-click="refBLIsInvalid = 'false'">
          <span ng-bind-html="'Une facture existe avec le m&ecirc;me BL' | safe_html"></span>
          <a>
            <i class="fa fa-times close-notif"></i>
          </a>
        </button>


      </div>
    </div>

    <div class="col-sm-12">


      <br />
      <span class="ms-ListItem-primaryText" ng-show="modePdf == 'actif'">
        Modification Facture</span>
      <span class="ms-ListItem-primaryText" ng-show="modePdf != 'actif'">
        Cr&eacute;ation Facture</span>
      <br />

      <div class="ms-CommandBar ms-CommandBar--navBar">
        <div class="ms-CommandBar-sideCommands">
          <div class="ms-CommandButton ms-CommandButton--noLabel">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon ms-fontColor-themePrimary"><i class="ms-Icon ms-Icon--Info"></i></span>
              <span class="ms-CommandButton-label"></span>
            </button>
          </div>
        </div>
        <div class="ms-CommandBar-mainArea">
       
       
           <div class="ms-CommandButton" permission="['V_Facture_Edit']">
            <button class="ms-CommandButton-button" ng-click="sauvegarderBonVente(factureVenteCourant,2)"
              ng-disabled="factureVenteCourant.partieIntId == null || factureVenteCourant.date == nul || (!factureVenteCourant.refCommande && clientActif.refCommandeFactureObligatoire) || (!factureVenteCourant.identifiant && clientActif.identifiantFactureObligatoire)">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--CirclePlus"></i></span>
              <span class="ms-CommandButton-label">Enregistrer</span>
            </button>
          </div>
       
      <!--     <div class="ms-CommandButton" permission="['V_Facture_Edit']">
            <button class="ms-CommandButton-button" ng-click="sauvegarderBonVente(factureVenteCourant,2)"
              ng-disabled="!creationFactureVenteForm.$valid ">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--CirclePlus"></i></span>
              <span class="ms-CommandButton-label">Enregistrer</span>
            </button>
          </div> -->

          <div class="ms-CommandButton ms-CommandButton--dropdown" ng-show="modePdf == 'actif'">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon ms-fontColor-themePrimary"><i
                  class="ms-Icon ms-Icon--Generate"></i></span>
              <span class="ms-CommandButton-label">G&eacute;n&eacute;rer</span>
              <span class="ms-CommandButton-dropdownIcon"><i class="ms-Icon ms-Icon--ChevronDown"></i></span>
            </button>
            <ul class="ms-ContextualMenu is-opened ms-ContextualMenu--hasIcons">
            
            
                 <li class="ms-ContextualMenu-item">


                <div class="row">
                  <div class="col-sm-8">
                    <a class="ms-ContextualMenu-link" tabindex="1" ng-show="modePdf == 'actif'"
                      ng-click="download(factureVenteCourant.id,2,factureVenteCourant.avecObservation)">Sans En-t&ecirc;te</a>

                  </div>

                  <div class="col-sm-2">
                    <label>Observ</label>
                    <input type="checkbox" ng-model="factureVenteCourant.avecObservation"
                      ng-init="factureVenteCourant.avecObservation" />


                  </div>
                </div>



              </li>
            
            
               <li class="ms-ContextualMenu-item">


                <div class="row">
                  <div class="col-sm-8">
                    <a class="ms-ContextualMenu-link" tabindex="1" ng-show="modePdf == 'actif'"
                      ng-click="download(factureVenteCourant.id,3,factureVenteCourant.avecObservation)">Avec En-t&ecirc;te </a>

                  </div>

                  <div class="col-sm-2">
                    <label>Observ</label>
                    <input type="checkbox" ng-model="factureVenteCourant.avecObservation"
                      ng-init="factureVenteCourant.avecObservation" />


                  </div>
                </div>



              </li>
              
               
               
             
            
            
         <!--      <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1" ng-show="modePdf == 'actif'"
                  ng-click="download(factureVenteCourant.id,2)">Sans En-t&ecirc;te</a>

              </li>
              
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1" ng-show="modePdf == 'actif'"
                  ng-click="download(factureVenteCourant.id,3)">Avec En-t&ecirc;te</a>

              </li> -->
              
           <!--    <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1" ng-show="modePdf == 'actif'"
                  ng-click="download(factureVenteCourant.id,5)">Sans En-t&ecirc;te $/€</a>

              </li>
              
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1" ng-show="modePdf == 'actif'"
                  ng-click="download(factureVenteCourant.id,4)">Avec En-t&ecirc;te $/€ </a>

              </li> -->
              
            </ul>
          </div>

          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="goLivraison()">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--Back"></i></span>
              <span class="ms-CommandButton-label">Livraison</span>
            </button>
          </div>

          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="annulerAjout()">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--Back"></i></span>
              <span class="ms-CommandButton-label">Retour</span>
            </button>
          </div>
          
          
           <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="annulerAjoutRapide()">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--Back"></i></span>
              <span class="ms-CommandButton-label">Retour Rapide</span>
            </button>
          </div>
          
          
          <div class="ms-CommandButton ms-CommandBar-overflowButton ms-CommandButton--noLabel">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--More"></i></span>
              <span class="ms-CommandButton-label"></span>
            </button>
            <ul class="ms-ContextualMenu is-opened">
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Folder</a>
                <i class="ms-Icon ms-Icon--Folder"></i>
              </li>
              <li class="ms-ContextualMenu-item ms-ContextualMenu-item--divider"></li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Plain Text Document</a>
                <i class="ms-Icon ms-Icon--Document"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">A Coffee</a>
                <i class="ms-Icon ms-Icon--Coffee"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Picture</a>
                <i class="ms-Icon ms-Icon--Picture"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Money</a>
                <i class="ms-Icon ms-Icon--Money"></i>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="panel panel-primary">
        <div class="panel-body">
          <form class="form-horizontal" name="creationFactureVenteForm" id="creationFactureVenteForm">
            <div class="row">
              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f.Facture</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.reference =''"
                      ng-model="factureVenteCourant.reference"
                      ng-disabled="modePdf != 'actif' && clientActif.disableVente" />
                  </div>
                </div>
              </div>

              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Client</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.partieIntId"
                      ng-change="getAvailableRefBLByClient(factureVenteCourant.partieIntId)" data-placeholder=""
                      class="form-control" style="border: 1px solid #e5eaee !important;">
                     <!--  <option value="">Tous</option> -->
                      <option ng-repeat="client in listePartieInteresseeCache | filter:{famillePartieInteressee:1}"
                        value="{{client.id}}">{{client.reference}}-{{client.abreviation}}</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Type</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.typePartieInteressee" data-placeholder="..."
                      required class="form-control" style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous</option>
                      <option ng-repeat="type in ListTypePICache" value="{{type.id}}">{{type.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-10">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text">R&eacute;f BL</span>
                    </div>
                    <input ui-select2="select2TaggingOptions" ng-model="tagReferenceBLivList" class="form-control"
                      style="border: 1px solid #e5eaee !important;" />
                  <!--   <div class="input-group-append">
                      <button class="btn" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        " ng-click="validerBL()">
                        Valider
                      </button>
                    </div> &nbsp;&nbsp; -->
                    
                      <div class="input-group-append">
                      <button class="btn" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        " ng-click="validerNatureFini()">
                        Valider
                      </button>
                    </div> &nbsp;&nbsp;
                    
                   <!--  <div class="input-group-append">
                      <button class="btn" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        " ng-click="validerBLPassager(factureVenteCourant.partieIntId,factureVenteCourant.date)">
                        Valider Passager
                      </button>
                    </div> -->

                  </div>
                </div>
              </div>


            </div>

            <div class="row">
              <div class="col-sm-4" ng-controller="DatepickerDemoController">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text ms-Label"> Date </span>
                    </div>
                    <input type="text" class="form-control datepicker" datepicker-popup="{{format}}"
                      ng-model="factureVenteCourant.date" is-open="opened" datepicker-options="dateOptions"
                      date-disabled="enabled(date, mode)" close-text="Close"  ng-change="calculerDateEcheance(factureVenteCourant.date,factureVenteCourant.modalitePaiement)"/>

                    <div class="input-group-append">
                      <button type="button" class="btn1 btn-default" ng-click="open($event)" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        ">
                        <i class="glyphicon glyphicon-calendar" style="color: #3699ff;"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              
              
                  <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Modalite de Paiement</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.modalitePaiement" data-placeholder="" 
                      class="form-control" style="border: 1px solid #e5eaee !important;" ng-change="calculerDateEcheance(factureVenteCourant.date,factureVenteCourant.modalitePaiement)">
                      <option value="A la reception">A la reception</option>
                       <option value="15 jours">15 jours</option>
                       <option value="1 mois">1 mois</option>
                      
                    
                    </select>
                  </div>
                </div>
              </div>


    <div class="col-sm-4" ng-controller="DatepickerDemoController">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text ms-Label"> Date Echeance </span>
                    </div>
                    <input type="text" class="form-control datepicker" datepicker-popup="{{format}}"
                      ng-model="factureVenteCourant.dateEcheance" is-open="opened" datepicker-options="dateOptions"
                      date-disabled="enabled(date, mode)" close-text="Close" />

                    <div class="input-group-append">
                      <button type="button" class="btn1 btn-default" ng-click="open($event)" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        ">
                        <i class="glyphicon glyphicon-calendar" style="color: #3699ff;"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              
              
              
          


            </div>
            
            
            
            <div class="row">
            
            
               <div class="col-sm-4">
                 <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f.Commande</label>
                    </div>
                    <input class="form-control" ng-init="factureVenteCourant.refCommande =''"
                      ng-model="factureVenteCourant.refCommande"
                        ng-required ="clientActif.refCommandeFactureObligatoire==true"
                      />
                  </div>
                </div>
              </div>
            
            

                <div class="col-sm-4">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Mode de Paiement</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.modepaiementId" data-placeholder="" required
                      class="form-control" style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous</option>
                      <option ng-repeat="modeP in listeModePaiement" value="{{modeP.id}}">{{modeP.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">March&eacute</label>
                    </div>
                    <select ui-select2 ng-model="factureVenteCourant.idMarche"
                      ng-init="factureVenteCourant.idMarche =''" data-placeholder="" class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous les March&eacute;s</option>
                      <option ng-repeat="marche in bllisteMarche" value="{{marche.id}}">{{marche.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>
            
            
            
            </div>


            <div class="row">
            
            
              <div class="col-sm-3">
                 <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Identifiant</label>
                    </div>
                    <input class="form-control" 
                      ng-model="factureVenteCourant.identifiant"
                      ng-required ="clientActif.identifiantFactureObligatoire==true"
                      />
                  </div>
                </div>
              </div>
              
              
              

              <div class="col-sm-3">
                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text">Devise </span>
                    </div>
                    <select ui-select2="true" class="form-control" ng-model="factureVenteCourant.devise"
                      ng-init="factureVenteCourant.devise=''">
                      <option ng-repeat="dev in ListeDevise" value="{{dev.id}}">
                        {{dev.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-sm-3">
                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label ">Taux Conversion </label>
                    </div>
                    <input class="form-control" type="number" step="any" ng-model="factureVenteCourant.tauxConversion "
                      ng-init="factureVenteCourant.tauxConversion =''" />


                  </div>
                </div>
              </div>
              <div class="col-sm-3" ng-show="clientActif.blackMode==true">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Declaree</label>
                    </div>
                    <div class="input-group-prepend">
                      <div class="input-group-text">
                        <label class="checkbox checkbox-square checkbox-primary">
                          <input type="checkbox" class="form-control" ng-init="factureVenteCourant.declarer=''"
                            ng-model="factureVenteCourant.declarer"
                            ng-change="getCurrentReferenceByType(factureVenteCourant.declarer)" />

                          <span></span></label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
                    <div class="col-sm-3" >


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Forcer calcul montant</label>
                    </div>
                    <div class="input-group-prepend">
                      <div class="input-group-text">
                        <label class="checkbox checkbox-square checkbox-primary">
                          <input type="checkbox" class="form-control"
                            ng-model="factureVenteCourant.forcerCalculMontant"
                            />

                          <span></span></label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>


            <div class="row">
              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Observations</label>
                    </div>
                    <textarea cols="9" rows="1" class="form-control"
                      ng-model="factureVenteCourant.observations"></textarea>
                  </div>
                </div>
              </div>
              <div class="col-sm-4" ng-controller="DatepickerDemoController">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text ms-Label"> Date Introduction</span>
                    </div>
                    <input class="form-control" readonly="readonly"
                    value="{{factureVenteCourant.dateIntroduction}}" datepicker-popup="{{format}}"
                      ng-model="factureVenteCourant.dateIntroduction"  />
                   

                    
                  </div>
                </div>
              </div>
            </div>




            <div class="alert alert-primary" ng-show="factureVenteCourant.forcerCalculMontant">
              <div class="row">
                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label is-required">Montant Taxe</label>
                      </div>
                      <input class="form-control" ng-model="factureVenteCourant.montantTaxe"
                        value="{{factureVenteCourant.montantTaxe | prixFiltre}}" />
                    </div>
                  </div>
                </div>
                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label is-required">Montant HT</label>
                      </div>
                      <input class="form-control" ng-model="factureVenteCourant.montantHTaxe"
                        value="{{factureVenteCourant.montantHTaxe | prixFiltre}}" />
                    </div>
                  </div>
                </div>
                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label ">Montant Remise</label>
                      </div>
                      <input class="form-control" ng-model="factureVenteCourant.montantRemise"
                        value="{{factureVenteCourant.montantRemise | prixFiltre}}" />
                    </div>
                  </div>
                </div>

                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label is-required">Montant TTC</label>
                      </div>
                      <input class="form-control" ng-model="factureVenteCourant.montantTTC"
                        value="{{factureVenteCourant.montantTTC | prixFiltre}}" />
                    </div>
                  </div>
                </div>


                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label is-required">Montant Converti </label>
                      </div>
                      <input class="form-control" readonly="readonly"
                        value="{{factureVenteCourant.montantConverti | prixFiltre}}" />
                    </div>
                  </div>
                </div>

              </div>
            </div>
            
            
                <div class="alert alert-primary" ng-show="!factureVenteCourant.forcerCalculMontant">
              <div class="row">
                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label is-required">Montant Taxe</label>
                      </div>
                      <input class="form-control" readonly="readonly"
                        value="{{factureVenteCourant.montantTaxe | prixFiltre}}" />
                    </div>
                  </div>
                </div>
                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label is-required">Montant HT</label>
                      </div>
                      <input class="form-control" readonly="readonly"
                        value="{{factureVenteCourant.montantHTaxe | prixFiltre}}" />
                    </div>
                  </div>
                </div>
                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label ">Montant Remise</label>
                      </div>
                      <input class="form-control" readonly="readonly"
                        value="{{factureVenteCourant.montantRemise | prixFiltre}}" />
                    </div>
                  </div>
                </div>

                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label is-required">Montant TTC</label>
                      </div>
                      <input class="form-control" readonly="readonly"
                        value="{{factureVenteCourant.montantTTC | prixFiltre}}" />
                    </div>
                  </div>
                </div>


                <div class="col-sm-4">


                  <div class="form-group">
                    <div class="input-group">
                      <div class="input-group-prepend">
                        <label class="input-group-text ms-Label is-required">Montant Converti </label>
                      </div>
                      <input class="form-control" readonly="readonly"
                        value="{{factureVenteCourant.montantConverti | prixFiltre}}" />
                    </div>
                  </div>
                </div>

              </div>
            </div>
            
            
            <br>


          </form>






          <!-- TAXE -->
          <div class="col-sm-12">
            <div class="title-ajout">Taxe</div>
            <div class="panel panel-primary">
              <div class="panel-body">
                <div class="form-group">

                  <!-- modeCreation -->
                  <div ng-show="modePdf != 'actif'" class="row">
                    <table class="table table-bordered table-hover table-condensed table-head-color">
                      <thead>
                        <tr>
                          <th style="width: 30%">Type</th>
                          <th style="width: 30%">Taux (%)</th>
                          <th style="width: 30%">Montant Taxe</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tr ng-repeat="taxeFacture in listTaxeFactureInit">
                        <td>
                          <!-- TODO: ID => Designation & DropList Field --> <span editable-select="taxeFacture.taxeId"
                            e-name="taxeId" e-form="rowform"
                            e-ng-options="s.id as s.designation for s in listeTaxes | filter:filterTaxes()">
                            {{ showTaxe(taxeFacture.taxeId) || 'empty' }} </span>
                        </td>
                        <td>
                          <!-- editable pourcentage (text with validation) --> <span
                            editable-text="taxeFacture.pourcentage" e-name="pourcentage" e-form="rowform" e-required> {{
                            taxeFacture.pourcentage
                            || '--' }} </span>
                        </td>
                        <td>
                          <!-- editable montant (text with validation) --> <span editable-text="taxeFacture.montant"
                            e-name="montant" e-form="rowform" e-required> {{ taxeFacture.montant ||
                            '--' }} </span>
                        </td>

                        <td>
                          <!-- form -->
                          <form editable-form name="rowform" onbeforesave="saveTaxeBLivInit($data)"
                            ng-show="rowform.$visible" class="form-buttons form-inline" shown="inserted == taxeFacture">
                            <button type="submit" ng-disabled="rowform.$waiting"
                              class="btn btn-sm glyphicon glyphicon-save" aria-hidden="true"></button>
                            <button type="button" ng-disabled="rowform.$waiting"
                              ng-click="cancelAddBLVente(rowform, $index, taxeFacture.taxeId, taxeFacture.montant, listTaxeLivraisonInit )"
                              class="btn btn-sm glyphicon glyphicon-remove"></button>
                          </form>
                          <div class="buttons" ng-show="!rowform.$visible">
                            <button ng-click="rowform.$show()" data-nodrag
                              class="btn btn-sm glyphicon glyphicon-pencil"></button>
                            <button ng-click="removeTaxeBLivInit($index, taxeFacture.taxeId)" data-nodrag
                              class="btn btn-sm glyphicon glyphicon-trash"></button>
                          </div>
                        </td>
                      </tr>
                    </table>

                    <button class="btn btn-default" ng-click="addTaxeBLivInit()">Ajouter</button>

                  </div>

                  <!-- modeModification -->
                  <div ng-show="modePdf == 'actif'" class="row">
                    <table class="table table-bordered table-hover table-condensed table-head-color">
                      <thead>
                        <tr>
                          <th style="width: 30%">Type</th>
                          <th style="width: 30%">Taux (%)</th>
                          <th style="width: 30%">Montant Taxe</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tr ng-repeat="taxeFacture in listTaxeFacture">
                        <td>
                          <!-- TODO: ID => Designation & DropList Field --> <span editable-select="taxeFacture.taxeId"
                            e-name="taxeId" e-form="rowform"
                            e-ng-options="s.id as s.designation for s in listeTaxes | filter:filterTaxes()">
                            {{ showTaxe(taxeFacture.taxeId) || 'empty' }} </span>
                        </td>
                        <td>
                          <!-- editable pourcentage (text with validation) --> <span
                            editable-text="taxeFacture.pourcentage" e-name="pourcentage" e-form="rowform" e-required> {{
                            taxeFacture.pourcentage
                            || '--' }} </span>
                        </td>
                        <td>
                          <!-- editable montant (text with validation) --> <span editable-text="taxeFacture.montant"
                            e-name="montant" e-form="rowform" e-required> {{ taxeFacture.montant |
                            prixFiltre }} </span>
                        </td>

                        <td>
                          <!-- form -->
                          <form editable-form name="rowform" onbeforesave="saveTaxeBLiv($data)"
                            ng-show="rowform.$visible" class="form-buttons form-inline" shown="inserted == taxeFacture">
                            <button type="submit" ng-disabled="rowform.$waiting"
                              class="btn btn-sm glyphicon glyphicon-save" aria-hidden="true"></button>
                            <button type="button" ng-disabled="rowform.$waiting"
                              ng-click="cancelAddBLVente(rowform, $index, taxeFacture.taxeId, taxeFacture.montant, listTaxeLivraison )"
                              class="btn btn-sm glyphicon glyphicon-remove"></button>
                          </form>
                          <div class="buttons" ng-show="!rowform.$visible">
                            <button ng-click="rowform.$show()" data-nodrag
                              class="btn btn-sm glyphicon glyphicon-pencil"></button>
                            <button ng-click="removeTaxeBLiv($index,taxeFacture.taxeId )" data-nodrag
                              class="btn btn-sm glyphicon glyphicon-trash"></button>
                          </div>
                        </td>
                      </tr>
                    </table>

                    <button class="btn btn-default" ng-click="addTaxeBLiv()">Ajouter</button>

                  </div>


                </div>
              </div>
            </div>
          </div>
          <!-- end TaxeDiv -->







          <div class="row">

          <!--   <div ng-if="natureLivraison == 'FINI'" class="col-sm-12"> -->
            
              <div class="col-sm-12">

              <span class="ms-ListItem-primaryText">Articles</span>


              <div class="panel panel-primary">
                <div class="panel-body">
                  <div class="form-group">
                  <div class="row">
                    <div class="col-sm-4">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">Service</label>
                          </div>
                          <select ui-select2 ng-model="produitIdFinancier" data-placeholder="..." class="form-control"
                            style="border: 1px solid #e5eaee !important;" e-name="produitIdFinancier" e-form="rowform">
                            <option value=""></option>
                            <option ng-repeat="produitFinancier in listeProduitFinancier" value="{{produitFinancier.id}}">
                              {{produitFinancier.designation}}</option>
                          </select>



                        </div>




                      </div>
                    </div>

                    <div class="col-sm-2">
                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <button type="button" class="btn btn-primary" class="btn btn-action"
                              ng-click="ajoutProduit(produitIdFinancier)">Ajouter</button>

                          </div>

                        </div>
                      </div>
                    </div>
                    
                    
                    
                    
								<div class="col-sm-4">


								<div class="form-group">
									<div class="input-group">
										<div class="input-group-prepend">
											<label class="input-group-text ms-Label">Produit</label>
										</div>
										<select ui-select2 ng-model="produitIdNonFinancier" data-placeholder="..."
											class="form-control" style="border: 1px solid #e5eaee !important;"
											e-name="produitIdNonFinancier" e-form="rowform">
											<option value=""></option>
											<option ng-repeat="produitNonFinancier in listeProduitNonFinancier" value="{{produitNonFinancier.id}}">
												{{produitNonFinancier.designation}}</option>
										</select>



									</div>




								</div>
							</div>

							<div class="col-sm-2">
								<div class="form-group">
									<div class="input-group">
										<div class="input-group-prepend">
											<button type="button" class="btn btn-primary" class="btn btn-action"
												ng-click="ajoutProduitNonFinancier(produitIdNonFinancier)">Ajouter</button>
	
										</div>
	
									</div>
								</div>
							</div>
                    
                    
                    
                    
                    
                    
                    

                  </div>

                 

                 
                    <div class="row">

                   <!--    <table class="table table-bordered table-hover table-condensed table-head-color"
                        ng-show="modeValider == 'actif'"> -->

   <table class="table table-bordered table-hover table-condensed table-head-color"
                        >
                        
                        <thead>
                          <tr style="font-weight: bold;">



                            <th style="width: 12%">Ref</th>
                            <th style="width: 25%">Designation</th>
                            <th style="width: 10%">Description</th>
                            <th style="width: 15%">OFs</th>
                            <th style="width: 7%">Quantite</th>
                            <!-- 			<th style="width: 10%">Unité</th> -->
                            <th style="width: 8%">P.U.H.T</th>
                            <th style="width: 7%">Remise</th>
                            <th style="width: 9%">P.T.H.T</th>
                            	<th style="width: 3%"></th>

                          </tr>
                        </thead>
                        <tr ng-repeat="detFactureVente in listDetFactureVentePRBL">
                          <td>{{ detFactureVente.produitReference || 'empty' }}</td>
                          <td>{{ detFactureVente.produitDesignation || 'empty' }}</td>
                          <td>
                            <input type="text" class="form-control" ng-model="detFactureVente.description" />
                          </td>
                      <!--     <td>{{ detFactureVente.numeroOF }}</td> -->
                           <td>
                            <input type="text" class="form-control" ng-model="detFactureVente.numeroOF" />
                          </td>
                          
                          <!-- <td>{{ detFactureVente.quantite }}</td> -->
                          
                            <td>
                            <input type="number" class="form-control" ng-model="detFactureVente.quantite" />
                          </td>
                        

                        <!--   <td>{{ detFactureVente.prixUnitaireHT }}</td> -->
                        
                        
                           <td>
                            <input type="number" class="form-control" ng-model="detFactureVente.prixUnitaireHT" />
                          </td>
                        
                          <td>
                            <input type="number" class="form-control" ng-change="remiseChanged($index)"
                              ng-model="detFactureVente.remise" placeholder="{{detFactureVente.remise}}"  />
                          </td>
                          <td>{{ detFactureVente.prixTotalHT | prixFiltre }}</td>
                          
                          
									<td><button data-nodrag class="btn btn-sm glyphicon glyphicon-trash"
											ng-click="removeProduit($index)"></button></td>
											
											
                        </tr>
                      </table>

                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>









        </div>

        <div class="row">
          <div class="col-sm-12">
            <div class="title-ajout" ng-show="modePdf == 'actif'">
              <span class="ms-ListItem-primaryText ">
                D&eacute;tails R&eacute;glement {{reglementCourante.reference}}

                <i class="fa fa-chevron-down clickable" style="margin-right: 5px;"
                  ng-click="isCollapsedDetailReglement = !isCollapsedDetailReglement"></i>
              </span>
            </div>

            <div class="panel-body" ng-show="modePdf == 'actif'">
              <div class="form-group" ng-show="modePdf == 'actif' && isCollapsedDetailReglement">
                <div class="row">


                  <table class="table table-bordered table-condensed table-head-color">
                    <thead>
                      <tr>
                        <th class="TableHeaderalignment" style="width: 15%;">
                          Type
                        </th>
                        <th class="TableHeaderalignment" style="width: 15%;">
                          N&deg; pi&eacute;ce
                        </th>
                        <th class="TableHeaderalignment" style="width: 10%;">
                          Banque
                        </th>
                        <th class="TableHeaderalignment" style="width: 10%;">
                          Montant
                        </th>
                        <th class="TableHeaderalignment" style="width: 10%;">
                          Emission
                        </th>
                        <th class="TableHeaderalignment" style="width: 10%;">
                          Ech&eacute;ance
                        </th>
                        <th class="TableHeaderalignment" style="width: 5%;">
                          Regl&eacute;
                        </th>
                        <th class="TableHeaderalignment" style="width: 15%;">
                          Observation
                        </th>
                        <th>
                          <span class="ms-CommandButton-icon float-right" id="todoSubmit" ng-click="addElement()">
                            <a href="javascript:void(0)">
                              <i class="ms-Icon ms-Icon--CirclePlus" style="color: #fff !important ;">
                              </i>
                            </a>
                          </span>
                        </th>
                      </tr>
                    </thead>
                    <tbody ng-model="finalOperationsList">
                      <tr ng-repeat="item in finalOperationsList track by $index ">
                        <td>
                          <select ui-select2 ng-model="item.typeReglementId" data-placeholder="..." class="form-control"
                            style="border: 1px solid #e5eaee !important;">
                            <option value="">Tous</option>
                            <option ng-repeat="pi in listTypes" value="{{pi.id}}">{{pi.designation}}</option>
                          </select>
                        </td>
                        <td>
                          <input class="form-control" ng-model="item.numPiece" />
                        </td>
                        <td>
                          <input class="form-control" ng-model="item.banque" />
                        </td>
                        <td>
                          <input type="number" class="form-control" ng-model="item.montant" />
                        </td>
                        <td>



                          <div class="input-group">

                            <input type="date" class="form-control" datepicker-popup="{{format}}"
                              ng-model="item.dateEmission" />


                          </div>


                        </td>
                        <td>




                          <div class="input-group">

                            <input type="date" class="form-control " datepicker-popup="{{format}}"
                              ng-model="item.dateEcheance" />


                          </div>



                        </td>
                        <td>
                          <input type="checkbox" ng-model="item.regle" />
                        </td>
                        <td>
                          <input class="form-control" ng-model="item.observation" />
                        </td>
                        <td>
                          <button class="btn btn-sm glyphicon glyphicon-trash"
                            ng-click="removeDetailRegelement($index)"></button>
                        </td>
                      </tr>
                    </tbody>
                  </table>

                </div>
                <div class="row">
                  <div class="col-sm-12">
                    <div class="pull-right">
                      <button class="btn btn-action" id="todoSubmit" ng-show="!reglementCourante.id"
                        ng-style="myStyleBtn" ng-mousedown="sauvegarderAjoutReglement(reglementCourante)">
                        Payer
                      </button>

                      <button class="btn btn-action" id="todoSubmit" ng-show="reglementCourante.id"
                        ng-mousedown="sauvegarderAjoutReglement(reglementCourante)">
                        Modifier
                      </button>


                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>









    <div ng-if="natureLivraison == 'FACON'" class="col-sm-12">
      <div class="title-ajout">Traitements Fa&ccedil;on</div>
      <div class="panel panel-primary">
        <div class="panel-body">
          <div class="form-group">
            <div class="row">

              <div ng-show="modeValider == 'actif'" class="panel panel-primary">
                <table class="table table-bordered table-hover table-condensed table-head-color">
                  <thead>
                    <tr style="font-weight: bold;">
                      <th style="width: 10%;">D&eacute;signation</th>
                      <th style="width: 10%;">R&eacute;f. Mise</th>
                      <th style="width: 10%;">Quantit&eacute;</th>

                      <th style="width: 10%;">Nbr.Colis</th>
                      <th style="width: 10%;">P.U.H.T</th>
                      <th style="width: 10%;">Remise</th>
                      <th style="width: 10%;">P.T.H.T</th>
                    </tr>
                  </thead>
                  <tr ng-repeat="detFactureVente in listDetFactureVentePRBL">
                    <td>
                      {{ detFactureVente.designationTraitement || 'empty' }}
                    </td>
                    <td>{{ detFactureVente.refMiseList || 'empty' }}</td>
                    <td>{{ detFactureVente.quantite || 'empty' }}</td>

                    <td>{{ detFactureVente.nombreColis || 'empty' }}</td>
                    <td>{{ detFactureVente.prixUnitaireHT || 'empty' }}</td>
                    <td>

                      <input type="text" class="form-control" ng-change="remiseChanged($index)"
                        ng-model="detFactureVente.remise" placeholder="{{detFactureVente.remise}}"  />
                    </td>
                    <td>{{ detFactureVente.prixTotalHT | prixFiltre }}</td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-sm-12">
      <span class="ms-ListItem-primaryText line">Documents</span>
      <div class="panel-body" ng-show="displayMode == 'edit'">
        <div class="form-group">
          <div class="row">
            <table class="table table-bordered table-condensed table-head-color">
              <thead>
                <tr>
                  <th class="hidden">Id</th>
                  <th>Type Document</th>
                  <th>Document</th>
                  <th>
                    <span class="ms-CommandButton-icon float-right" ng-click="ajoutDocumentProduit()">
                      <a href="javascript:void(0)">
                        <i class="ms-Icon ms-Icon--CirclePlus" style="color: #fff !important ;">
                        </i>
                      </a>
                    </span>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr ng-repeat="documentProduit in listeDocumentProduit">
                  <td class="hidden">

                    <span editable-text="documentProduit.id" e-name="id" e-form="rowform" e-required>
                      {{ documentProduit.id || 'empty' }}
                    </span>
                  </td>
                  <td>

                    <span editable-select="documentProduit.typeDocumentId"
                      e-ng-options="s.id as s.designation for s in listeTypeDocumentsCache" e-name="idTypeDocPROD"
                      e-form="rowform">
                      {{showStatus(documentProduit.typeDocumentId)}}
                    </span>

                  </td>
                  <td ng-controller="UploadCtrl">

                    <div class="form-group">
                      <div class="col-sm-12">
                        <div class="fileinput fileinput-new" data-provides="fileinput">
                          <input class="hidden" type="text" ng-model="name" />
                          <span class="btn btn-file btn-sm" style="
                              color: rgb(54, 153, 255);
                              background-color: rgb(225, 240, 255);
                              border-color: transparent;
                            " ng-show="!isUploaded && rowform.$visible">
                            <span class="fileinput-new">Selectionner fichier</span>
                            <input type="file" class="custom-file-input" file-model="myFile" />
                            <span href="#" class="close fileinput-exists pull-right" style="float: none; padding: 0;"
                              data-dismiss="fileinput" ng-show="!isUploaded && rowform.$visible">x</span>
                          </span>
                          <span class="fileinput-filename" ng-model="documentProduit.path" e-name="path"
                            e-form="rowform" e-required>{{documentProduit.path}}</span>
                        </div>
                        <a class="btn btn-sm pull-right" style="margin-right: 10px; cursor: pointer;"
                          ng-click="downloadFile(documentProduit.uidDocument, 'VENTE_FACTURE')">
                          <a style="margin-right: 10px; cursor: pointer;"
                            ng-click="downloadFile(documentPi.vUUIDDocument, 'VENTE_FACTURE')">
                            <span class="svg-icon svg-icon-primary svg-icon-2x">
                              <!--begin::Svg Icon | path:C:\wamp64\www\keenthemes\themes\metronic\theme\html\demo1\dist/../src/media/svg/icons\Files\Download.svg--><svg
                                xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                  <rect x="0" y="0" width="24" height="24" />
                                  <path
                                    d="M2,13 C2,12.5 2.5,12 3,12 C3.5,12 4,12.5 4,13 C4,13.3333333 4,15 4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,13 C20,12.4477153 20.4477153,12 21,12 C21.5522847,12 22,12.4477153 22,13 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 C2,15 2,13.3333333 2,13 Z"
                                    fill="#000000" fill-rule="nonzero" opacity="0.3" />
                                  <rect fill="#000000" opacity="0.3"
                                    transform="translate(12.000000, 8.000000) rotate(-180.000000) translate(-12.000000, -8.000000) "
                                    x="11" y="1" width="2" height="14" rx="1" />
                                  <path
                                    d="M7.70710678,15.7071068 C7.31658249,16.0976311 6.68341751,16.0976311 6.29289322,15.7071068 C5.90236893,15.3165825 5.90236893,14.6834175 6.29289322,14.2928932 L11.2928932,9.29289322 C11.6689749,8.91681153 12.2736364,8.90091039 12.6689647,9.25670585 L17.6689647,13.7567059 C18.0794748,14.1261649 18.1127532,14.7584547 17.7432941,15.1689647 C17.3738351,15.5794748 16.7415453,15.6127532 16.3310353,15.2432941 L12.0362375,11.3779761 L7.70710678,15.7071068 Z"
                                    fill="#000000" fill-rule="nonzero"
                                    transform="translate(12.000004, 12.499999) rotate(-180.000000) translate(-12.000004, -12.499999) " />
                                </g>
                              </svg>
                              <!--end::Svg Icon-->
                            </span></a></a>

                        <a ng-click="uploadFile('VENTE_FACTURE')" ng-show="!isUploaded && rowform.$visible"
                          class="btn btn-sm fileinput-upload pull-right">
                          <span class="svg-icon svg-icon-primary svg-icon-2x">
                            <!--begin::Svg Icon | path:C:\wamp64\www\keenthemes\themes\metronic\theme\html\demo1\dist/../src/media/svg/icons\Files\Upload.svg--><svg
                              xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px"
                              height="24px" viewBox="0 0 24 24" version="1.1">
                              <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                <rect x="0" y="0" width="24" height="24" />
                                <path
                                  d="M2,13 C2,12.5 2.5,12 3,12 C3.5,12 4,12.5 4,13 C4,13.3333333 4,15 4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,13 C20,12.4477153 20.4477153,12 21,12 C21.5522847,12 22,12.4477153 22,13 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 C2,15 2,13.3333333 2,13 Z"
                                  fill="#000000" fill-rule="nonzero" opacity="0.3" />
                                <rect fill="#000000" opacity="0.3" x="11" y="2" width="2" height="14" rx="1" />
                                <path
                                  d="M12.0362375,3.37797611 L7.70710678,7.70710678 C7.31658249,8.09763107 6.68341751,8.09763107 6.29289322,7.70710678 C5.90236893,7.31658249 5.90236893,6.68341751 6.29289322,6.29289322 L11.2928932,1.29289322 C11.6689749,0.916811528 12.2736364,0.900910387 12.6689647,1.25670585 L17.6689647,5.75670585 C18.0794748,6.12616487 18.1127532,6.75845471 17.7432941,7.16896473 C17.3738351,7.57947475 16.7415453,7.61275317 16.3310353,7.24329415 L12.0362375,3.37797611 Z"
                                  fill="#000000" fill-rule="nonzero" />
                              </g>
                            </svg>
                            <!--end::Svg Icon-->
                          </span>
                        </a>
                      </div>
                    </div>
                    <input class="hidden" ng-model="documentProduit.uidDocument" e-name="uidDocument" e-form="rowform"
                      e-required value="{{ documentProduit.uidDocument ||
															'empty' }} " />
                  </td>
                  <td style="white-space: nowrap;">

                    <form editable-form name="rowform" onbeforesave="saveDocumentProduit($data, documentProduit.id)"
                      ng-show="rowform.$visible" class="form-buttons form-inline float-right"
                      shown="DocumentProduitInserree == documentProduit">
                      <button type="submit" ng-disabled="rowform.$waiting" class="btn btn-sm" aria-hidden="true">
                        <i class="ms-Icon ms-Icon--Download" aria-hidden="true"></i>
                      </button>

                      <button type="button" ng-disabled="rowform.$waiting"
                        ng-click="cancelAddProduit(rowform, $index, documentProduit.id, documentProduit.typeDocumentId, listeDocumentProduit )"
                        class="btn btn-sm">
                        <i class="ms-Icon ms-Icon--Cancel" aria-hidden="true"></i>
                      </button>
                    </form>
                    <div class="buttons" ng-show="!rowform.$visible">
                      <button data-nodrag class="btn btn-sm " ng-click="rowform.$show()">
                        <i class="ms-Icon ms-Icon--Edit" aria-hidden="true"></i>

                      </button>
                      <button data-nodrag class="btn btn-sm " ng-click="removeDocumentProduit($index)">
                        <i class="ms-Icon ms-Icon--Delete" aria-hidden="true"></i>

                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="row" ng-show="displayMode != 'edit'">
    <div class="col-md-12">

      <span class="ms-ListItem-primaryText line">Liste des Factures</span>
      <div style="height: 500px;" ng-grid="gridOptions"></div>
    </div>
  </div>


  <div id="light" class="white_content">
    <pop-up type="delete-bonVente"></pop-up>
  </div>
  <div id="fade" class="black_overlay"></div>
</div>