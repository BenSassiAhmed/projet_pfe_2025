<script type="text/javascript">
  var CommandBarElements = document.querySelectorAll(".ms-CommandBar");
  for (var i = 0; i < CommandBarElements.length; i++) {
    new fabric['CommandBar'](CommandBarElements[i]);
  }

  var SearchBoxElements = document.querySelectorAll(".ms-SearchBox");
  for (var i = 0; i < SearchBoxElements.length; i++) {
    new fabric['SearchBox'](SearchBoxElements[i]);
  }

</script>







<div class="container-fluid" ng-controller="bonlivraisonControllerGC" style="background-color: #fff;">

  <div class="row" ng-show="traitementEnCoursGenererAll =='true'">
    <div class="col-sm-5"></div>
    <div class="col-sm-2">
      <br>
      <div ng-click="traitementEnCoursGenererAll ='false'">


        <div class="lds-ellipsis">
          <div></div>
          <div></div>
          <div></div>
          <div></div>
        </div>




      </div>

    </div>
    <div class="col-sm-5"></div>

  </div>

  <div class="row" ng-show="displayMode != 'edit'">
    <div class="col-sm-12">
      <br />

      <span class="ms-ListItem-primaryText">Bon de livraison</span>
      <br />



      <div class="ms-CommandBar ms-CommandBar--navBar">
        <div class="ms-CommandBar-sideCommands">
          <div class="ms-CommandButton ms-CommandButton--noLabel">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon ms-fontColor-themePrimary"><i class="ms-Icon ms-Icon--Info"></i></span>
              <span class="ms-CommandButton-label"></span>
            </button>
          </div>
        </div>
        <div class="ms-CommandBar-mainArea">
          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="affectationBLVente(bonLivraisonVenteCourant)">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--CirclePlus"></i></span>
              <span class="ms-CommandButton-label">Ajouter</span>
            </button>
          </div>

          <div class="ms-CommandButton ms-CommandButton--dropdown">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon ms-fontColor-themePrimary"><i
                  class="ms-Icon ms-Icon--Generate"></i></span>
              <span class="ms-CommandButton-label">G&eacute;n&eacute;rer</span>
              <span class="ms-CommandButton-dropdownIcon"><i class="ms-Icon ms-Icon--ChevronDown"></i></span>
            </button>
            <ul class="ms-ContextualMenu is-opened ms-ContextualMenu--hasIcons">
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1"
                  ng-click="downloadAllBonLiv(bonLivraisonVenteCourant)">PDF</a>

              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1"
                  ng-click="downloadAllBonLivExcel(bonLivraisonVenteCourant)">EXCEL</a>

              </li>
            </ul>
          </div>
          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="rechercherBonLivraisonVente(bonLivraisonVenteCourant)">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--FolderSearch"></i></span>
              <span class="ms-CommandButton-label">Rechercher</span>
            </button>
          </div>

          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="annulerAjout()">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--Cancel"></i></span>
              <span class="ms-CommandButton-label">Annuler</span>
            </button>
          </div>
          <div class="ms-CommandButton ms-CommandBar-overflowButton ms-CommandButton--noLabel">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--More"></i></span>
              <span class="ms-CommandButton-label"></span>
            </button>
            <ul class="ms-ContextualMenu is-opened">
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Folder</a>
                <i class="ms-Icon ms-Icon--Folder"></i>
              </li>
              <li class="ms-ContextualMenu-item ms-ContextualMenu-item--divider"></li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Plain Text Document</a>
                <i class="ms-Icon ms-Icon--Document"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">A Coffee</a>
                <i class="ms-Icon ms-Icon--Coffee"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Picture</a>
                <i class="ms-Icon ms-Icon--Picture"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Money</a>
                <i class="ms-Icon ms-Icon--Money"></i>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="panel panel-primary">
        <div class="panel-body">
          <form class="form-horizontal" name="rechercheBLVenteForm" id="rechercheBLVenteForm">
            <div class="row">
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f.BL</label>
                    </div>
                    <input class="form-control" ng-init="bonLivraisonVenteCourant.referenceBl =''"
                      ng-model="bonLivraisonVenteCourant.referenceBl" />
                  </div>
                </div>
              </div>

              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Client</label>
                    </div>
                    <select ui-select2 ng-init="bonLivraisonVenteCourant.partieIntId =''"
                      ng-model="bonLivraisonVenteCourant.partieIntId" data-placeholder="" class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous les Clients</option>
                      <option ng-repeat="client in listePartieInteresseeCache | filter:{famillePartieInteressee:1}"
                        value="{{client.id}}">{{client.reference}}-{{client.abreviation}}</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="col-sm-3">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Etat</label>
                    </div>
                    <input class="form-control" ng-init="bonLivraisonVenteCourant.etat =''"
                      ng-model="bonLivraisonVenteCourant.etat" />
                  </div>
                </div>
              </div>
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Facture</label>
                    </div>
                    <select ui-select2 ng-model="bonLivraisonVenteCourant.avecFacture"
                      ng-init="bonLivraisonVenteCourant.avecFacture=''" data-placeholder="" class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value="">Tout type</option>
                      <option value="ouiFacture">Oui</option>
                      <option value="nonFacture">Non</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-sm-3" ng-hide="true">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f.BS</label>
                    </div>
                    <input class="form-control" ng-init="bonLivraisonVenteCourant.referenceBs =''"
                      ng-model="bonLivraisonVenteCourant.referenceBs" />
                  </div>
                </div>
              </div>
              <div class="col-sm-3" ng-hide="true">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f.BC</label>
                    </div>
                    <input class="form-control" ng-init="bonLivraisonVenteCourant.referenceBC =''"
                      ng-model="bonLivraisonVenteCourant.referenceBC" />
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-3">


                <div class="form-group" ng-controller="DatepickerDemoController">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text"> Date Liv.Entre</span>
                    </div>
                    <input type="text" class="form-control datepicker" datepicker-popup="{{format}}"
                      ng-init="bonLivraisonVenteCourant.dateLivraisonMin =''"
                      ng-model="bonLivraisonVenteCourant.dateLivraisonMin" is-open="opened"
                      datepicker-options="dateOptions" date-disabled="enabled(date, mode)" ng-required="false"
                      close-text="Close" />

                    <div class="input-group-append">
                      <button type="button" class="btn1 btn-default" ng-click="open($event)" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        ">
                        <i class="glyphicon glyphicon-calendar" style="color: #3699ff;"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-3" ng-controller="DatepickerDemoController">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text"> Et</span>
                    </div>
                    <input type="text" class="form-control datepicker" datepicker-popup="{{format}}"
                      ng-init="bonLivraisonVenteCourant.dateLivraisonMax =''"
                      ng-model="bonLivraisonVenteCourant.dateLivraisonMax" is-open="opened"
                      datepicker-options="dateOptions" date-disabled="enabled(date, mode)" ng-required="false"
                      close-text="Close" />

                    <div class="input-group-append">
                      <button type="button" class="btn1 btn-default" ng-click="open($event)" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        ">
                        <i class="glyphicon glyphicon-calendar" style="color: #3699ff;"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Prix Entre</label>
                    </div>
                    <input type="number" class="form-control" min="0" pattern="^\d*(\.\d{0,2})?$" placeholder="0.00"
                      value="0" name="prixMin" ng-init="bonLivraisonVenteCourant.prixMin =''"
                      ng-model="bonLivraisonVenteCourant.prixMin" />
                  </div>

                  <div ng-show="
                  rechercheBLVenteForm.prixMin.$dirty && rechercheBLVenteForm.prixMin.$invalid" class="error">
                    <div ng-show="rechercheBLVenteForm.prixMin.$error">
                      La valeur doit être supérieure ou égale à 0 !
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-3">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">ET</label>
                    </div>
                    <input class="form-control" min="0" pattern="^\d*(\.\d{0,2})?$" placeholder="0.00" value="0"
                      name="prixMax" type="number" ng-init="bonLivraisonVenteCourant.prixMax =''"
                      ng-model="bonLivraisonVenteCourant.prixMax" />
                  </div>
                  <div ng-show="
                  rechercheBLVenteForm.prixMax.$dirty && rechercheBLVenteForm.prixMax.$invalid" class="error">
                    <div ng-show="rechercheBLVenteForm.prixMax.$error">
                      La valeur doit être supérieure ou égale à 0 !
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Ref.Externe</label>
                    </div>
                    <input class="form-control" ng-init="bonLivraisonVenteCourant.refexterne =''"
                      ng-model="bonLivraisonVenteCourant.refexterne" />
                  </div>
                </div>
              </div>
              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Quantit&eacute;</label>
                    </div>
                    <input class="form-control" type="number" min="0" pattern="^\d*(\.\d{0,2})?$" placeholder="0.00"
                      value="0" name="metrageMin" ng-init="bonLivraisonVenteCourant.metrageMin =''"
                      ng-model="bonLivraisonVenteCourant.metrageMin" />
                  </div>

                  <div ng-show="
                  rechercheBLVenteForm.metrageMin.$dirty && rechercheBLVenteForm.metrageMin.$invalid" class="error">
                    <div ng-show="rechercheBLVenteForm.metrageMin.$error">
                      La valeur doit être supérieure ou égale à 0 !
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Et</label>
                    </div>
                    <input class="form-control" min="0" pattern="^\d*(\.\d{0,2})?$" placeholder="0.00" value="0"
                      name="metrageMax" type="number" ng-init="bonLivraisonVenteCourant.metrageMax =''"
                      ng-model="bonLivraisonVenteCourant.metrageMax" />
                  </div>
                  <div ng-show="
                  rechercheBLVenteForm.metrageMax.$dirty && rechercheBLVenteForm.metrageMax.$invalid" class="error">
                    <div ng-show="rechercheBLVenteForm.metrageMax.$error">
                      La valeur doit être supérieure ou égale à 0 !
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-3">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">A facturer</label>
                    </div>
                    <select ui-select2 ng-model="bonLivraisonVenteCourant.declare"
                      ng-init="bonLivraisonVenteCourant.declare =''" data-placeholder="" class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous</option>
                      <option value="oui">OUI</option>
                      <option value="non">NON</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Groupe</label>
                    </div>
                    <select ui-select2 ng-model="bonLivraisonVenteCourant.groupeClientId"
                      ng-init="bonLivraisonVenteCourant.groupeClientId =''" data-placeholder="..." class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous</option>
                      <option ng-repeat="groupe in listGroupeClient" value="{{groupe.id}}">{{groupe.designation}}
                      </option>
                    </select>
                  </div>
                </div>
              </div>



              <div class="col-sm-3">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Magasin</label>
                    </div>
                    <select ui-select2 ng-init="bonLivraisonVenteCourant.idDepot =''"
                      ng-model="bonLivraisonVenteCourant.idDepot" data-placeholder="" class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous les Magasins</option>
                      <option ng-repeat="magazin in listeMagazinCache" value="{{magazin.id}}">{{magazin.designation}}
                      </option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">March&eacute;</label>
                    </div>
                    <select ui-select2 ng-model="bonLivraisonVenteCourant.marcheId"
                      ng-init="bonLivraisonVenteCourant.marcheId =''" data-placeholder="" class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous les Marchés</option>
                      <option ng-repeat="marche in bllisteMarche" value="{{marche.id}}">{{marche.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Client Passager</label>
                    </div>
                    <input class="form-control" ng-model="bonLivraisonVenteCourant.transporteur" />
                  </div>
                </div>
              </div>

              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">N° Tel Passager</label>
                    </div>
                    <input class="form-control" ng-model="bonLivraisonVenteCourant.numTelPassager" />
                  </div>
                </div>
              </div>

              <div class="col-sm-3">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Email Passager</label>
                    </div>
                    <input class="form-control" ng-model="bonLivraisonVenteCourant.emailPassager" />
                  </div>
                </div>
              </div>

              <div class="col-sm-3">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Adresse Passager</label>
                    </div>
                    <input class="form-control" ng-model="bonLivraisonVenteCourant.adressePassager" />
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-sm">


                <div class="form-group float-right">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Stock</label>
                    </div>
                    <div class="input-group-prepend">
                      <div class="input-group-text">
                        <label class="checkbox checkbox-square checkbox-primary">
                          <input type="checkbox" ng-model="checkboxModelRech.stock" ng-true-value="oui"
                            ng-false-value="non" />
                          <span></span></label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>

      </div>
    </div>
  </div>

  <div class="row" ng-show="traitementEnCours=='true'" ng-click="traitementEnCours ='false'">
    <div class="col-sm-5"></div>
    <div class="col-sm-2">
      <br>
      <div>
        <div>

          <div class="lds-spinner">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
        </div>
        <div></div>
        <div>{{msg}}</div>


      </div>

    </div>
    <div class="col-sm-5"></div>

  </div>


  <div class="row" ng-hide="hiddenNotif">

    <div class="col-sm-8"></div>
    <div class="col-sm-4">
      <br> <span>
        <alert type="success" class="alert-success-sauvegarde light"
          style="text-align: center !important; background-color: #1BC5BD !important">
          <span ng-bind-html="'Bon Livraison enregistr&eacute;e avec succ&egrave;s.' | safe_html"></span>
          <a> <i class="fa fa-times close-notif" ng-click="closeNotif()" style="color: #fff !important;"></i>
          </a> </alert>
      </span>
    </div>
  </div>

  <div class="row" ng-show="traitementEnCoursGenererLivraison =='true'">
    <div class="col-sm-5"></div>
    <div class="col-sm-2">
      <br>
      <div ng-click="traitementEnCoursGenererLivraison ='false'">


        <div class="lds-ellipsis">
          <div></div>
          <div></div>
          <div></div>
          <div></div>
        </div>




      </div>

    </div>
    <div class="col-sm-5"></div>

  </div>


  <div class="row" ng-show="displayMode == 'edit'">
    <div class="col-sm-12">
      <div class="pull-right">
        <br />
        <div class="row">

          <!--       
          <div class="col-sm-12" ng-show="hiddenNotifSucc">
            <div class="ms-MessageBar ms-MessageBar--error mx-auto float-left" style="width: 300px !important;">
              <div class="ms-MessageBar-content">
                <div class="ms-MessageBar-icon" ng-click="hiddenNotifSucc = 'false'">
                  <i class="ms-Icon ms-Icon--ErrorBadge"></i>
                </div>
                <div class="ms-MessageBar-text">
                  <b>BL existe d&egrave;ja</b>
                  <br />
                </div>
              </div>
            </div>
          </div> -->

          <div class="col-sm-12" ng-show="refBLIsInvalid">
            <div class="ms-MessageBar ms-MessageBar--error mx-auto float-left" style="width: 300px !important;">
              <div class="ms-MessageBar-content">
                <div class="ms-MessageBar-icon" ng-click="refBLIsInvalid = 'false'">
                  <i class="ms-Icon ms-Icon--ErrorBadge"></i>
                </div>
                <div class="ms-MessageBar-text">
                  <b>Invalid reference BL ! caractere ( - ) invalid</b>
                  <br />
                </div>
              </div>
            </div>
          </div>

          <div class="col-sm-12" ng-show="erreurUpdateBL">
            <div class="ms-MessageBar ms-MessageBar--error mx-auto float-left" style="width: 300px !important;">
              <div class="ms-MessageBar-content">
                <div class="ms-MessageBar-icon" ng-click="erreurUpdateBL = 'false'">
                  <i class="ms-Icon ms-Icon--ErrorBadge"></i>
                </div>
                <div class="ms-MessageBar-text">
                  <b>{{msgErreurUpdateBL}}</b>
                  <br />
                </div>
              </div>
            </div>
          </div>

        </div>
        <br />



        <!--  <div
          class="btn btn-outline-info"
          ng-show="traitementEnCours=='true'"
          ng-click="traitementEnCours ='false'"
        >
          <div>
            <div class="lds-spinner">
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
              <div></div>
            </div>
          </div>
          <div></div>
          <div>{{msg}}</div>
        </div> -->






      </div>
    </div>

    <br />
    <br />


    <div class="col-sm-12">

      <br />

      <span class="ms-ListItem-primaryText" ng-show="modePdf == 'actif'">Modification Bon De Livraison</span>
      <span class="ms-ListItem-primaryText" ng-show="modePdf != 'actif'">
        Cr&eacute;ation Bon De Livraison</span>
      <br />

      <div class="ms-CommandBar ms-CommandBar--navBar">
        <div class="ms-CommandBar-sideCommands">
          <div class="ms-CommandButton ms-CommandButton--noLabel">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon ms-fontColor-themePrimary"><i class="ms-Icon ms-Icon--Info"></i></span>
              <span class="ms-CommandButton-label"></span>
            </button>
          </div>
        </div>
        <div class="ms-CommandBar-mainArea">
          <div class="ms-CommandButton" permission="['V_Livraison_Edit']">
            <button class="ms-CommandButton-button"
              ng-disabled="!creationBLVenteForm.$valid || traitementEnCours=='true' || !isValidSauvegarde()"
              ng-click="sauvegarderBonVente(bonLivraisonVenteCourant)">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--Save"></i></span>
              <span class="ms-CommandButton-label">Enregistrer</span>
            </button>
          </div>

          <div class="ms-CommandButton ms-CommandButton--dropdown" ng-show="modePdf == 'actif'">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon ms-fontColor-themePrimary"><i
                  class="ms-Icon ms-Icon--Generate"></i></span>
              <span class="ms-CommandButton-label">G&eacute;n&eacute;rer</span>
              <span class="ms-CommandButton-dropdownIcon"><i class="ms-Icon ms-Icon--ChevronDown"></i></span>
            </button>
            <ul class="ms-ContextualMenu is-opened ms-ContextualMenu--hasIcons">
              <li class="ms-ContextualMenu-item">
                <div class="row">
                  <div class="col-sm-8">
                    <a class="ms-ContextualMenu-link" tabindex="1" ng-show="modePdf == 'actif'"
                      ng-click="download(bonLivraisonVenteCourant.id, 'oui',2)">Sans En-t&ecirc;te </a>


                  </div>

                  <div class="col-sm-2">
                    <label>Prix</label>
                    <input type="checkbox" ng-model="checkboxModel.rapportPrix"
                      ng-init="checkboxModel.rapportPrix='oui'" ng-true-value="oui" ng-false-value="non" />


                  </div>
                </div>



              </li>
              <li class="ms-ContextualMenu-item">


                <div class="row">
                  <div class="col-sm-8">
                    <a class="ms-ContextualMenu-link" tabindex="1" ng-show="modePdf == 'actif'"
                      ng-click="download(bonLivraisonVenteCourant.id, 'oui',3)">Avec En-t&ecirc;te </a>

                  </div>

                  <div class="col-sm-2">
                    <label>Prix</label>
                    <input type="checkbox" ng-model="checkboxModel.rapportPrix"
                      ng-init="checkboxModel.rapportPrix='oui'" ng-true-value="oui" ng-false-value="non" />


                  </div>
                </div>





              </li>

              <li class="ms-ContextualMenu-item">

                <div class="row">
                  <div class="col-sm-8">
                    <a class="ms-ContextualMenu-link" tabindex="1" ng-show="modePdf == 'actif'"
                      ng-click="download(bonLivraisonVenteCourant.id, 'oui',4)">Ticket</a>

                  </div>

                  <div class="col-sm-2">
                    <label>Prix</label>
                    <input type="checkbox" ng-model="checkboxModel.rapportPrix"
                      ng-init="checkboxModel.rapportPrix='oui'" ng-true-value="oui" ng-false-value="non" />


                  </div>
                </div>





              </li>
            </ul>
          </div>


          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="redirectToFacture(bonLivraisonVenteCourant)">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--FolderSearch"></i></span>
              <span class="ms-CommandButton-label">Facture</span>
            </button>
          </div>

          <div class="ms-CommandButton">
            <button class="ms-CommandButton-button" ng-click="annulerAjout()">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--Back"></i></span>
              <span class="ms-CommandButton-label">Retour</span>
            </button>
          </div>
          <div class="ms-CommandButton ms-CommandBar-overflowButton ms-CommandButton--noLabel">
            <button class="ms-CommandButton-button">
              <span class="ms-CommandButton-icon"><i class="ms-Icon ms-Icon--More"></i></span>
              <span class="ms-CommandButton-label"></span>
            </button>
            <ul class="ms-ContextualMenu is-opened">
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Folder</a>
                <i class="ms-Icon ms-Icon--Folder"></i>
              </li>
              <li class="ms-ContextualMenu-item ms-ContextualMenu-item--divider"></li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Plain Text Document</a>
                <i class="ms-Icon ms-Icon--Document"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">A Coffee</a>
                <i class="ms-Icon ms-Icon--Coffee"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Picture</a>
                <i class="ms-Icon ms-Icon--Picture"></i>
              </li>
              <li class="ms-ContextualMenu-item">
                <a class="ms-ContextualMenu-link" tabindex="1">Money</a>
                <i class="ms-Icon ms-Icon--Money"></i>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="panel panel-primary">
        <div class="panel-body">
          <form class="form-horizontal" name="creationBLVenteForm" id="creationBLVenteForm">
            <div class="row">
              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f&eacute;rence</label>
                    </div>
                    <input class="form-control" ng-model="bonLivraisonVenteCourant.reference"
                      ng-disabled="modePdf != 'actif' && clientActif.disableVente" />
                  </div>
                </div>
              </div>

              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Client</label>
                    </div>
                    <select ui-select2 required ng-model="bonLivraisonVenteCourant.partieIntId"
                      ng-init="bonLivraisonVenteCourant.partieIntId =''"
                      ng-change="getAvailableRefBCByClient(bonLivraisonVenteCourant.partieIntId)" data-placeholder=""
                      class="form-control" style="border: 1px solid #e5eaee !important;">
                      <option value="">Tous les Clients</option>
                      <option ng-repeat="client in listePartieInteresseeCache | filter:{famillePartieInteressee:1}"
                        value="{{client.id}}">{{client.reference}}-{{client.abreviation}}</option>
                    </select>
                  </div>
                </div>
              </div>



              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Mode de Paiement</label>
                    </div>
                    <select ui-select2 ng-model="bonLivraisonVenteCourant.modepaiementId"
                      ng-init="bonLivraisonVenteCourant.modepaiementId =''" data-placeholder="" class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value=""></option>
                      <option ng-repeat="modeP in listeModePaiement" value="{{modeP.id}}">{{modeP.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>



            </div>

            <div class="row">

              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Magasin</label>
                    </div>
                    <select ui-select2 required ng-model="bonLivraisonVenteCourant.idDepot"
                      ng-init="bonLivraisonVenteCourant.idDepot =''" data-placeholder="" required class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option ng-repeat="magazin in listeMagazinCache" value="{{magazin.id}}">{{magazin.designation}}
                      </option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Type Client</label>
                    </div>
                    <select ui-select2 ng-model="bonLivraisonVenteCourant.typePartieInteressee"
                      ng-init="bonLivraisonVenteCourant.typePartieInteressee =''" data-placeholder="..." required
                      class="form-control" style="border: 1px solid #e5eaee !important;">
                      <option ng-repeat="type in ListTypePICache" value="{{type.id}}">{{type.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>




              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Ref.Externe</label>
                    </div>
                    <input class="form-control" ng-model="bonLivraisonVenteCourant.refexterne" />
                  </div>
                </div>
              </div>



            </div>


            <div class="row">

              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">R&eacute;f BC</label>
                    </div>
                    <input ui-select2="select2TaggingOptions" ng-model="tagReferenceBLivList" class="form-control"
                      style="border: 1px solid #e5eaee !important;" />

                    <div class="input-group-append">
                      <button class="btn" style="
                          color: rgb(54, 153, 255);
                          background-color: rgb(225, 240, 255);
                        " ng-mousedown="validerBC()">
                        Valider
                      </button>
                    </div>

                  </div>
                </div>




              </div>
              <!-- <div class="col-sm-4">
                <div class="form-group">
                 <div class="input-group">
                   <div class="input-group-prepend">
                     <label class="input-group-text ms-Label">R&eacute;f.Commande</label>
                   </div>
                   <input class="form-control" ng-init="bonLivraisonVenteCourant.tagReferenceBLivList =''"
                     ng-model="bonLivraisonVenteCourant.tagReferenceBLivList"
                     />
                 </div>
               </div>
             </div> -->
           
           
           
           
                    <div class="col-sm-4">
                <div class="form-group">
                 <div class="input-group">
                   <div class="input-group-prepend">
                     <label class="input-group-text ms-Label">Identifiant</label>
                   </div>
                   <input class="form-control" ng-init="bonLivraisonVenteCourant.identifiantLivraison =''"
                     ng-model="bonLivraisonVenteCourant.identifiantLivraison"
                     />
                 </div>
               </div>
             </div>

            </div>

            <div class="row">


              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Groupe</label>
                    </div>
                    <select ui-select2 ng-model="bonLivraisonVenteCourant.groupeClientId"
                      ng-init="bonLivraisonVenteCourant.groupeClientId =''" data-placeholder="..." class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value=""></option>
                      <option ng-repeat="groupe in listGroupeClient" value="{{groupe.id}}">{{groupe.designation}}
                      </option>
                    </select>
                  </div>
                </div>
              </div>


              <div class="col-sm-4">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">March&eacute;</label>
                    </div>
                    <select ui-select2 ng-model="bonLivraisonVenteCourant.marcheId"
                      ng-init="bonLivraisonVenteCourant.marcheId =''" data-placeholder="" class="form-control"
                      style="border: 1px solid #e5eaee !important;">
                      <option value=""></option>
                      <option ng-repeat="marche in listeMarche" value="{{marche.id}}">{{marche.designation}}</option>
                    </select>
                  </div>
                </div>
              </div>


              <div class="col-sm-4">

                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Pourcentage Remise</label>
                    </div>
                    <input class="form-control" ng-model="bonLivraisonVenteCourant.totalPourcentageRemise" />
                  </div>
                </div>
              </div>






            </div>


            <div class="row">



              <div class="col-sm-6" ng-controller="DatepickerDemoController">





                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text">
                        Date Livraison</span>
                    </div>
                    <input type="text" class="form-control datepicker" datepicker-popup="{{format}}"
                      ng-model="bonLivraisonVenteCourant.date" is-open="opened" datepicker-options="dateOptions"
                      date-disabled="enabled(date, mode)" close-text="Close" />

                    <div class="input-group-append">
                      <button type="button" class="btn1 btn-default" ng-click="open($event)" style="
                              color: rgb(54, 153, 255);
                              background-color: rgb(225, 240, 255);
                            ">
                        <i class="glyphicon glyphicon-calendar" style="color: #3699ff;"></i>
                      </button>
                    </div>
                  </div>
                </div>





              </div>

              <div class="col-sm-6">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Etat</label>
                    </div>
                    <input class="form-control" ng-model="bonLivraisonVenteCourant.etat" disabled />
                  </div>
                </div>
              </div>



            </div>

            <div class="row">
              <div class="col-sm-2">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">Stock</label>
                    </div>
                    <div class="input-group-prepend">
                      <div class="input-group-text">
                        <label class="checkbox checkbox-square checkbox-primary">
                          <input type="checkbox" ng-model="checkboxModel.stock" ng-true-value="oui"
                            ng-false-value="non" />
                          <span></span></label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-sm-2">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">desc.</label>
                    </div>
                    <div class="input-group-prepend">
                      <div class="input-group-text">
                        <label class="checkbox checkbox-square checkbox-primary">
                          <input type="checkbox" ng-init="checkboxModel.description='non'" />

                          <span></span></label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>


              <div class="col-sm-2">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label is-required">A facturer</label>
                    </div>
                    <div class="input-group-prepend">
                      <div class="input-group-text">
                        <label class="checkbox checkbox-square checkbox-primary">
                          <input type="checkbox" class="form-control" ng-init="bonLivraisonVenteCourant.declare=false"
                            ng-model="bonLivraisonVenteCourant.declare" />

                          <span></span></label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col-sm-6">


                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <label class="input-group-text ms-Label">Observations</label>
                    </div>
                    <input class="form-control" ng-model="bonLivraisonVenteCourant.observations" />
                  </div>
                </div>
              </div>




            </div>






            <span class="ms-ListItem-primaryText">
              Client Passager
              <i class="fa fa-chevron-down clickable" style="margin-right: 5px;"
                ng-click="isCollapsedClientPassager = !isCollapsedClientPassager"></i></span>

            <div class="panel panel-primary">
              <div class="panel-body">
                <div class="alert alert-primary" ng-if="isCollapsedClientPassager">
                  <div class="row">
                    <div class="col-sm-4">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">Client Passager</label>
                          </div>
                          <input class="form-control" ng-model="bonLivraisonVenteCourant.transporteur" />
                        </div>
                      </div>
                    </div>

                    <div class="col-sm-4">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">N° Tel Passager</label>
                          </div>
                          <input class="form-control" ng-model="bonLivraisonVenteCourant.numTelPassager" />
                        </div>
                      </div>
                    </div>

                    <div class="col-sm-4">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">Email Passager</label>
                          </div>
                          <input class="form-control" ng-model="bonLivraisonVenteCourant.emailPassager" />
                        </div>
                      </div>
                    </div>

                    <div class="col-sm-4">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">Adresse Passager</label>
                          </div>
                          <input class="form-control" ng-model="bonLivraisonVenteCourant.adressePassager" />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>



            <span class="ms-ListItem-primaryText">
              Montants
              <i class="fa fa-chevron-down clickable" style="margin-right: 5px;"
                ng-click="isCollapsedMontants = !isCollapsedMontants"></i></span>

            <div class="panel panel-primary">
              <div class="panel-body">
                <div class="alert alert-primary" ng-if="isCollapsedMontants">
                  <div class="row">
                    <div class="col-sm-4">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">Montant Taxe</label>
                          </div>
                          <input class="form-control" readonly="readonly"
                            value="{{bonLivraisonVenteCourant.montantTaxe | prixFiltre}}" />
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-4">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">Montant HT</label>
                          </div>
                          <input class="form-control" readonly="readonly"
                            value="{{bonLivraisonVenteCourant.montantHTaxe | prixFiltre}}" />
                        </div>
                      </div>
                    </div>
                    <div class="col-sm-4">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">Montant Remise</label>
                          </div>
                          <input class="form-control" readonly="readonly"
                            value="{{bonLivraisonVenteCourant.montantRemise | prixFiltre}}" />
                        </div>
                      </div>
                    </div>

                    <div class="col-sm-4">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">Montant TTC</label>
                          </div>
                          <input class="form-control" readonly="readonly"
                            value="{{bonLivraisonVenteCourant.montantTTC | prixFiltre}}" />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">

              <div class="col-sm-12">

                <span class="ms-ListItem-primaryText" ng-show="modePdf == 'actif'">
                  D&eacute;tails R&eacute;glement {{reglementCourante.reference}}
                  <i class="fa fa-chevron-down clickable" style="margin-right: 5px;"
                    ng-click="isCollapsedDetailReglement = !isCollapsedDetailReglement"></i></span>

                <div class="panel-body" ng-show="modePdf == 'actif'">
                  <div class="form-group" ng-show="modePdf == 'actif' && isCollapsedDetailReglement">
                    <div class="row">
                      <div class="panel panel-primary">
                        <table class="table table-bordered table-condensed table-head-color">
                          <thead>
                            <tr>
                              <th class="TableHeaderalignment" style="width: 15%;">
                                Type
                              </th>
                              <th class="TableHeaderalignment" style="width: 15%;">
                                N&deg; pi&eacute;ce
                              </th>
                              <th class="TableHeaderalignment" style="width: 10%;">
                                Banque
                              </th>
                              <th class="TableHeaderalignment" style="width: 10%;">
                                Montant
                              </th>
                              <th class="TableHeaderalignment" style="width: 10%;">
                                Emission
                              </th>
                              <th class="TableHeaderalignment" style="width: 10%;">
                                Ech&eacute;ance
                              </th>
                              <th class="TableHeaderalignment" style="width: 5%;">
                                Regl&eacute;
                              </th>
                              <th class="TableHeaderalignment" style="width: 15%;">
                                Observation
                              </th>
                              <th>
                                <span class="ms-CommandButton-icon float-right" ng-click="addElement()">
                                  <a href="javascript:void(0)">
                                    <i class="ms-Icon ms-Icon--CirclePlus" style="color: #fff !important ;">
                                    </i>
                                  </a>
                                </span>
                              </th>
                            </tr>
                          </thead>
                          <tbody ng-model="finalOperationsList">
                            <tr ng-repeat="item in finalOperationsList track by $index ">
                              <td>
                                <select ui-select2 ng-model="item.typeReglementId" data-placeholder="..."
                                  class="form-control" style="border: 1px solid #e5eaee !important;">
                                  <option ng-repeat="pi in listTypes" value="{{pi.id}}">{{pi.designation}}</option>
                                </select>
                              </td>
                              <td>
                                <input class="form-control" ng-model="item.numPiece" />
                              </td>
                              <td>
                                <input class="form-control" ng-model="item.banque" />
                              </td>
                              <td>
                                <input type="number" class="form-control" ng-model="item.montant" />
                              </td>
                              <td>






                                <div class="input-group">

                                  <input type="date" class="form-control" datepicker-popup="{{format}}"
                                    ng-model="item.dateEmission" />


                                </div>





                              </td>
                              <td>




                                <div class="input-group">

                                  <input type="date" class="form-control " datepicker-popup="{{format}}"
                                    ng-model="item.dateEcheance" />


                                </div>

                              </td>
                              <td>
                                <input type="checkbox" ng-model="item.regle" />
                              </td>
                              <td>
                                <input class="form-control" ng-model="item.observation" />
                              </td>
                              <td>
                                <button class="btn btn-sm glyphicon glyphicon-trash"
                                  ng-click="removeDetailRegelement($index)"></button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-12">
                        <div class="pull-right">
                          <button class="btn btn-action" id="todoSubmit" ng-show="!reglementCourante.id"
                            ng-style="myStyleBtn" ng-mousedown="sauvegarderAjoutReglement(reglementCourante)">
                            Payer
                          </button>

                          <button class="btn btn-action" id="todoSubmit" ng-show="reglementCourante.id"
                            ng-mousedown="sauvegarderAjoutReglement(reglementCourante)">
                            Modifier
                          </button>

                          <!-- <button class="btn btn-action" id="todoSubmit" ng-click="addElement()">
                            Ajouter
                          </button> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>




            <div class="row">

              <div class="col-sm-12">


                <span class="ms-ListItem-primaryText ">Articles</span>
                <br />

                <div class="panel-body">

                  <div class="row">
                    <div class="col-sm-6">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">N&ordm; Article</label>
                          </div>
                          <input type="text" class="form-control" ng-model="codeBarre"
                            ng-keyup="keyPress($event.keyCode, codeBarre)" />
                        </div>
                      </div>
                    </div>
                    
                          <div class="col-sm-6">


                      <div class="form-group">
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <label class="input-group-text ms-Label">N&ordm; Serie</label>
                          </div>
                          <input type="text" class="form-control" ng-init="serieNumber = ''" ng-model="serieNumber"
                            ng-keyup="numSerieIsScanned($event.keyCode, serieNumber)" />
                        </div>
                      </div>
                    </div>

                    <br />
                    <br />
                    <br />



                    <table ng-show="modePdf != 'actif'" class="table table-bordered table-condensed table-head-color">
                      <thead>
                        <tr style="font-weight: bold;">

                          <th style="width: 15%">Ref.Article</th>
                          <th style="width: 25%">Article</th>
                          <th style="width: 5%">Qte Dispo</th>
                          <th style="width: 6%">Quantite</th>
                          <th style="width: 10%">P.U.H.T</th>
                          <th style="width: 8%">P.U.T.T.C</th>
                          <th style="width: 10%">P.T.H.T</th>
                          <th style="width: 7%">Remise</th>
                          <th style="width: 4%">N&ordm;S</th>


                          <th>
                            <span class="ms-CommandButton-icon float-right" ng-click="ajoutProduit()">
                              <a href="javascript:void(0)">
                                <i class="ms-Icon ms-Icon--CirclePlus" style="color: #fff !important ;">
                                </i>
                              </a>
                            </span>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr ng-repeat="detLivVente in listDetLivraisonVente | reverse">
                          <td>
                            <select ui-select2 ng-model="detLivVente.produitId"
                              ng-change="clickProduit(detLivVente.produitId, $index,true)" data-placeholder="..."
                              class="form-control" style="border: 1px solid #e5eaee !important;" e-name="produitId"
                              e-form="rowform">
                              <option value="">Tous</option>
                              <option ng-repeat="produit in listeProduitCache" value="{{produit.id}}">
                                {{produit.reference}}
                              </option>
                            </select>
                          </td>

                          <td>
                            <select ui-select2 ng-model="detLivVente.produitId"
                              ng-change="clickProduit(detLivVente.produitId, $index,true)" data-placeholder="..."
                              class="form-control" style="border: 1px solid #e5eaee !important;" e-name="produitId"
                              e-form="rowform">
                              <option value="">Tous</option>
                              <option ng-repeat="produit in listeProduitCache" value="{{produit.id}}">
                                {{produit.designation}}</option>
                            </select>
                          </td>

                          <td>{{ detLivVente.quantiteStock | number:3}}</td>

                          <td>
                            <input type="number" class="form-control" ng-model="detLivVente.quantite" e-name="quantite"
                              e-form="rowform" min="0" pattern="^\d*(\.\d{0,2})?$" placeholder="0" value="0"
                              name="quantite" />

                          </td>




                          <td>
                            <input type="text" class="form-control" ng-model="detLivVente.prixUnitaireHT"
                              e-name="prixUnitaireHT" e-form="rowform"
                              ng-change="detLivVente.prixTTC = ((detLivVente.prixUnitaireHT)*(1+detLivVente.tauxTVA/100)).toFixed(3)" />
                          </td>
                          <td>
                            <input type="text" class="form-control" ng-model="detLivVente.prixTTC" e-name="prixTTC"
                              e-form="rowform"
                              ng-change="detLivVente.prixUnitaireHT = ((detLivVente.prixTTC)/(1+detLivVente.tauxTVA/100)).toFixed(3)" />
                          </td>
                          <td>
                            {{(detLivVente.quantite*detLivVente.prixUnitaireHT) |
                  number:3}}
                          </td>
                          <td>
                            <input type="number" class="form-control" ng-model="detLivVente.remise" e-name="remise"
                              e-form="rowform" />
                          </td>

                          <td
                            ng-style="isSerialisable(detLivVente.produitId) &&  detLivVente.quantite !== nbrSelectedProduitsSerialisable(detLivVente.produitsSerialisable) && {'background-color':'coral'}">
                            <a class="fa fa-barcode" ng-if="isSerialisable(detLivVente.produitId)"
                              data-target="#SeriesModal{{$index}}" data-toggle="modal">
                            </a>

                            <div class="modal fade" tabindex="-1" id="SeriesModal{{$index}}" data-keyboard="false"
                              data-backdrop="static">
                              <div class="modal-dialog modal-sm">
                                <div class="modal-content" style="
                          width: 1100px !important;
                          left: 50%;
                          top: 0;
                          display: block;
                          position: absolute;
                          margin: 100px auto !important;
                          transform: translate(-50%, -0%);
                          background-color: #fff;

                          z-index: 1002;
                        ">
                                  <div class="modal-header">
                                    <h4 class="modal-title">
                                      {{getReferenceArticleAndDesignation(detLivVente.produitId)}}
                                    </h4>
                                    <button type="button" class="close" data-dismiss="modal">
                                      &times;
                                    </button>
                                  </div>
                                  <div class="modal-body">
                                    <form>
                                      <div class="row">
                                        <div class="col-sm-6">
                                          <div class="form-group">
                                            <div class="input-group">
                                              <div class="input-group-prepend">
                                                <label class="input-group-text ms-Label">N&ordm; Serie</label>
                                              </div>
                                              <input type="text" class="form-control" ng-init="numSerieFilter =''"
                                                ng-model="numSerieFilter" />
                                            </div>
                                          </div>


                                        </div>
                                      </div>

                                      <table class="table table-bordered table-condensed table-head-color">
                                        <thead>
                                          <tr>
                                            <th style="width: 20%;">N&ordm; Serie</th>
                                            <th style="width: 20%;">Fournisseur</th>
                                            <th style="width: 20%;">
                                              N&ordm; Bon R&eacute;ception
                                            </th>
                                            <th style="width: 20%;">Date Achat</th>
                                            <th style="width: 10%;">
                                              Date Fin Garantie
                                            </th>
                                            <th style="width: 10%;"></th>
                                          </tr>
                                        </thead>

                                        <tbody>
                                          <tr
                                            ng-repeat="produitSerialisable in detLivVente.produitsSerialisable | filter:{numSerie:numSerieFilter}">
                                            <td>{{produitSerialisable.numSerie}}</td>
                                            <td>
                                              {{produitSerialisable.fournisseurAbreviation}}
                                            </td>
                                            <td>
                                              {{produitSerialisable.numBonReception}}
                                            </td>
                                            <td>
                                              {{produitSerialisable.dateAchat |
                                    date:"dd-MM-yyyy"}}
                                            </td>

                                            <td>
                                                 <input type="date" class="form-control datepicker"
                                                    datepicker-popup="{{format}}"
                                                    ng-model="produitSerialisable.dateFinGarantie" is-open="opened"
                                                    datepicker-options="dateOptions" date-disabled="enabled(date, mode)"
                                                    close-text="Close" />
                                            </td>

                                            <td>
                                              <input type="checkbox" class="form-control"
                                                ng-model="produitSerialisable.checked" />
                                            </td>


                                          </tr>
                                        </tbody>
                                      </table>
                                    </form>
                                  </div>
                                  <div class="modal-footer">

                                    <button type="button" class="btn btn-primary" data-dismiss="modal">
                                      Retour
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </td>

                          <td style="white-space: nowrap;">

                            <form editable-form name="rowform" onbeforesave="saveProduit($data, produit.id)"
                              ng-show="rowform.$visible" class="form-buttons form-inline"
                              shown="produitInserree == produit">
                              <button type="submit" ng-disabled="rowform.$waiting"
                                class="btn btn-sm glyphicon glyphicon-save" aria-hidden="true"></button>
                              <button type="button" ng-disabled="rowform.$waiting"
                                ng-click="cancelAddCommandeVente(rowform, $index,  produit.id, produit.produitId )"
                                class="btn btn-sm glyphicon glyphicon-remove"></button>
                            </form>
                            <div class="buttons" ng-show="!rowform.$visible">
                              <button data-nodrag class="btn btn-sm glyphicon glyphicon-trash"
                                ng-click="removeProduit($index)"></button>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>



                    <div ng-show="isLoading" class="col-sm-2" style="
              float: none;
              margin-left: auto;
              margin-right: auto;
              font-weight: bold;
            " class="col-sm-1">
                      Chargement ...
                    </div>



                    <table ng-show="modePdf == 'actif'" class="table table-bordered table-condensed table-head-color">
                      <thead>
                        <tr style="font-weight: bold;">
                          <th style="width: 15%">Ref.Article</th>
                          <th style="width: 25%">Article</th>
                          <th style="width: 5%">Qte Dispo</th>
                          <th style="width: 6%">Quantite</th>
                          <th style="width: 10%">P.U.H.T</th>
                          <th style="width: 8%">P.U.T.T.C</th>
                          <th style="width: 10%">P.T.H.T</th>
                          <th style="width: 7%">Remise</th>
                          <th style="width: 4%">N&ordm;S</th>
                          <th>
                            <span class="ms-CommandButton-icon float-right" ng-click="ajoutProduit()">
                              <a href="javascript:void(0)">
                                <i class="ms-Icon ms-Icon--CirclePlus" style="color: #fff !important ;">
                                </i>
                              </a>
                            </span>
                          </th>
                        </tr>
                      </thead>

                      <tbody>
                        <tr ng-repeat="detLivVente in listDetLivraisonVente | reverse">
                          <td>
                            <select ui-select2 ng-model="detLivVente.produitId"
                              ng-change="clickProduit(detLivVente.produitId, $index,true)" data-placeholder="..."
                              class="form-control" style="border: 1px solid #e5eaee !important;" e-name="produitId"
                              e-form="rowform">
                              <option value="">Tous</option>
                              <option ng-repeat="produit in listeProduitCache" value="{{produit.id}}">
                                {{produit.reference}}
                              </option>
                            </select>
                          </td>
                          <td>
                            <select ui-select2 ng-model="detLivVente.produitId"
                              ng-change="clickProduit(detLivVente.produitId, $index,true)" data-placeholder="..."
                              class="form-control" style="border: 1px solid #e5eaee !important;" e-name="produitId"
                              e-form="rowform">
                              <option value="">Tous</option>
                              <option ng-repeat="produit in listeProduitCache" value="{{produit.id}}">
                                {{produit.designation}}</option>
                            </select>
                          </td>
                          <td>{{ detLivVente.quantiteStock | number:3}}</td>
                          <td>
                            <input type="number" class="form-control" ng-model="detLivVente.quantite" e-name="quantite"
                              e-form="rowform" min="0" pattern="^\d*(\.\d{0,2})?$" placeholder="0" value="0"
                              name="quantite" />

                          </td>

                          <td>
                            <input type="text" class="form-control" ng-model="detLivVente.prixUnitaireHT"
                              e-name="prixUnitaireHT" e-form="rowform" />
                          </td>
                          <td>
                            <input type="text" class="form-control" ng-model="detLivVente.prixTTC" e-name="prixTTC"
                              e-form="rowform"
                              ng-change="detLivVente.prixUnitaireHT = ((detLivVente.prixTTC)/(1+detLivVente.tauxTVA/100)).toFixed(3)" />
                          </td>
                          <td>
                            {{(detLivVente.quantite*detLivVente.prixUnitaireHT) | number:3
                  }}
                          </td>
                          <td>
                            <input type="number" class="form-control" ng-model="detLivVente.remise" e-name="remise"
                              e-form="rowform" />
                          </td>

                          <td
                            ng-style="isSerialisable(detLivVente.produitId) &&  detLivVente.quantite !== detLivVente.produitsSerialisable.length && {'background-color':'coral'}">
                            <a class="fa fa-barcode" ng-if="isSerialisable(detLivVente.produitId)"
                              data-target="#SeriesModalEdit{{$index}}" data-toggle="modal">
                            </a>

                            <div class="modal fade" tabindex="-1" id="SeriesModalEdit{{$index}}" data-keyboard="false"
                              data-backdrop="static">
                              <div class="modal-dialog modal-sm">
                                <div class="modal-content" style="
                          width: 1100px !important;
                          left: 50%;
                          top: 0;
                          display: block;
                          position: absolute;
                          margin: 100px auto !important;
                          transform: translate(-50%, -0%);
                          background-color: #fff;
                          z-index: 1002;
                        ">
                                  <div class="modal-header">
                                    <h4 class="modal-title">
                                      {{getReferenceArticleAndDesignation(detLivVente.produitId)}}
                                    </h4>

                                    <button type="button" class="close" data-dismiss="modal">
                                      &times;
                                    </button>
                                  </div>
                                  <div class="modal-body">
                                    <form>
                                      <div class="row">
                                        <div class="col-sm-6">
                                          <div class="form-group">
                                            <div class="input-group">
                                              <div class="input-group-prepend">
                                                <label class="input-group-text ms-Label">N&ordm; Serie</label>
                                              </div>
                                              <input type="text" class="form-control" ng-init="numSerie =''"
                                                ng-model="numSerie" />
                                            </div>
                                          </div>
                                        </div>
                                        <div class="col-sm-1">
                                          <button type="button" class="btn btn-primary"
                                            ng-click="ajouterNumSerieWS(numSerie,$index,detLivVente.produitId)">
                                            Ajouter
                                          </button>
                                        </div>
                                      </div>

                                      <table class="table table-bordered table-condensed table-head-color">
                                        <thead>
                                          <tr>
                                            <th style="width: 20%;">N&ordm; Serie</th>
                                            <th style="width: 20%;">Fournisseur</th>
                                            <th style="width: 20%;">
                                              N&ordm; Bon R&eacute;ception
                                            </th>
                                            <th style="width: 20%;">Date Achat</th>
                                            <th style="width: 15%;">
                                              Date Fin Garantie
                                            </th>

                                            <th style="width: 5%;"></th>
                                          </tr>
                                        </thead>

                                        <tbody>
                                          <tr ng-repeat="produitSerialisable in detLivVente.produitsSerialisable">
                                            <td>{{produitSerialisable.numSerie}}</td>

                                            <td>
                                              {{getAbreviationPIbyId(produitSerialisable.fournisseurId)}}
                                            </td>

                                            <td>
                                              {{produitSerialisable.numBonReception}}
                                            </td>
                                            <td>
                                              {{produitSerialisable.dateAchat |
                                    date:"dd-MM-yyyy"}}
                                            </td>
                                            <td>


                                              <div class="form-group">


                                                <div class="input-group">
                                                  <input type="date" class="form-control datepicker"
                                                    datepicker-popup="{{format}}"
                                                    ng-model="produitSerialisable.dateFinGarantie" is-open="opened"
                                                    datepicker-options="dateOptions" date-disabled="enabled(date, mode)"
                                                    close-text="Close" />


                                                </div>
                                              </div>


                                            </td>

                                            <td class="pull-right">
                                              <button class="btn btn-sm glyphicon glyphicon-trash"
                                                ng-mousedown="removeNumSerie($parent.$index,$index)"></button>
                                            </td>
                                          </tr>
                                        </tbody>
                                      </table>
                                    </form>
                                  </div>
                                  <div class="modal-footer">

                                    <button type="button" class="btn btn-primary" data-dismiss="modal">
                                      Retour
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </td>



                          <td style="white-space: nowrap;">
                            <button class="btn btn-sm glyphicon glyphicon-trash"
                              ng-click="removeProduit($index)"></button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                </div>
              </div>
            </div>





          </form>
        </div>


        <div class="col-sm-12">

          <span class="ms-ListItem-primaryText ">Documents</span>

          <div class="panel-body" ng-show="displayMode == 'edit'">
            <div class="form-group">
              <div class="row">
                <table class="table table-bordered table-condensed table-head-color">
                  <thead>
                    <tr>
                      <th class="hidden">Id</th>
                      <th>Type Document</th>
                      <th>Document</th>
                      <th>
                        <span class="ms-CommandButton-icon float-right" ng-click="ajoutDocumentProduit()">
                          <a href="javascript:void(0)">
                            <i class="ms-Icon ms-Icon--CirclePlus" style="color: #fff !important ;">
                            </i>
                          </a>
                        </span>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr ng-repeat="documentProduit in listeDocumentProduit">
                      <td class="hidden">

                        <span editable-text="documentProduit.id" e-name="id" e-form="rowform" e-required>
                          {{ documentProduit.id || 'empty' }}
                        </span>
                      </td>
                      <td>

                        <span editable-select="documentProduit.typeDocumentId"
                          e-ng-options="s.id as s.designation for s in listeTypeDocumentsCache" e-name="idTypeDocPROD"
                          e-form="rowform">
                          {{showStatus(documentProduit.typeDocumentId)}}
                        </span>

                      </td>
                      <td ng-controller="UploadCtrl">

                        <div class="form-group">
                          <div class="col-sm-12">
                            <div class="fileinput fileinput-new" data-provides="fileinput">
                              <input class="hidden" type="text" ng-model="name" />
                              <span class="btn btn-file btn-sm" style="
                        color: rgb(54, 153, 255);
                        background-color: rgb(225, 240, 255);
                        border-color: transparent;
                      " ng-show="!isUploaded && rowform.$visible">
                                <span class="fileinput-new">Selectionner fichier</span>
                                <input type="file" class="custom-file-input" file-model="myFile" />
                                <span href="#" class="close fileinput-exists pull-right"
                                  style="float: none; padding: 0;" data-dismiss="fileinput"
                                  ng-show="!isUploaded && rowform.$visible">x</span>
                              </span>
                              <span class="fileinput-filename" ng-model="documentProduit.path" e-name="path"
                                e-form="rowform" e-required>{{documentProduit.path}}</span>
                            </div>

                            <a class="btn btn-sm pull-right" style="margin-right: 10px; cursor: pointer;"
                              ng-click="downloadFile(documentProduit.uidDocument, 'VENTE_LIVRAISON')">
                              <span class="svg-icon svg-icon-primary svg-icon-2x">
                                <!--begin::Svg Icon | path:C:\wamp64\www\keenthemes\themes\metronic\theme\html\demo1\dist/../src/media/svg/icons\Files\Download.svg--><svg
                                  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                  width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <rect x="0" y="0" width="24" height="24" />
                                    <path
                                      d="M2,13 C2,12.5 2.5,12 3,12 C3.5,12 4,12.5 4,13 C4,13.3333333 4,15 4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,13 C20,12.4477153 20.4477153,12 21,12 C21.5522847,12 22,12.4477153 22,13 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 C2,15 2,13.3333333 2,13 Z"
                                      fill="#000000" fill-rule="nonzero" opacity="0.3" />
                                    <rect fill="#000000" opacity="0.3"
                                      transform="translate(12.000000, 8.000000) rotate(-180.000000) translate(-12.000000, -8.000000) "
                                      x="11" y="1" width="2" height="14" rx="1" />
                                    <path
                                      d="M7.70710678,15.7071068 C7.31658249,16.0976311 6.68341751,16.0976311 6.29289322,15.7071068 C5.90236893,15.3165825 5.90236893,14.6834175 6.29289322,14.2928932 L11.2928932,9.29289322 C11.6689749,8.91681153 12.2736364,8.90091039 12.6689647,9.25670585 L17.6689647,13.7567059 C18.0794748,14.1261649 18.1127532,14.7584547 17.7432941,15.1689647 C17.3738351,15.5794748 16.7415453,15.6127532 16.3310353,15.2432941 L12.0362375,11.3779761 L7.70710678,15.7071068 Z"
                                      fill="#000000" fill-rule="nonzero"
                                      transform="translate(12.000004, 12.499999) rotate(-180.000000) translate(-12.000004, -12.499999) " />
                                  </g>
                                </svg>
                                <!--end::Svg Icon--></span></a>

                            <a ng-click="uploadFile('VENTE_LIVRAISON')" ng-show="!isUploaded && rowform.$visible"
                              class="btn btn-sm fileinput-upload pull-right">
                              <span class="svg-icon svg-icon-primary svg-icon-2x">
                                <!--begin::Svg Icon | path:C:\wamp64\www\keenthemes\themes\metronic\theme\html\demo1\dist/../src/media/svg/icons\Files\Upload.svg--><svg
                                  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                  width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <rect x="0" y="0" width="24" height="24" />
                                    <path
                                      d="M2,13 C2,12.5 2.5,12 3,12 C3.5,12 4,12.5 4,13 C4,13.3333333 4,15 4,18 C4,19.1045695 4.8954305,20 6,20 L18,20 C19.1045695,20 20,19.1045695 20,18 L20,13 C20,12.4477153 20.4477153,12 21,12 C21.5522847,12 22,12.4477153 22,13 L22,18 C22,20.209139 20.209139,22 18,22 L6,22 C3.790861,22 2,20.209139 2,18 C2,15 2,13.3333333 2,13 Z"
                                      fill="#000000" fill-rule="nonzero" opacity="0.3" />
                                    <rect fill="#000000" opacity="0.3" x="11" y="2" width="2" height="14" rx="1" />
                                    <path
                                      d="M12.0362375,3.37797611 L7.70710678,7.70710678 C7.31658249,8.09763107 6.68341751,8.09763107 6.29289322,7.70710678 C5.90236893,7.31658249 5.90236893,6.68341751 6.29289322,6.29289322 L11.2928932,1.29289322 C11.6689749,0.916811528 12.2736364,0.900910387 12.6689647,1.25670585 L17.6689647,5.75670585 C18.0794748,6.12616487 18.1127532,6.75845471 17.7432941,7.16896473 C17.3738351,7.57947475 16.7415453,7.61275317 16.3310353,7.24329415 L12.0362375,3.37797611 Z"
                                      fill="#000000" fill-rule="nonzero" />
                                  </g>
                                </svg>
                                <!--end::Svg Icon--></span>
                            </a>
                          </div>
                        </div>
                        <input class="hidden" ng-model="documentProduit.uidDocument" e-name="uidDocument"
                          e-form="rowform" e-required value="{{ documentProduit.uidDocument ||
                        'empty' }} " />
                      </td>
                      <td style="white-space: nowrap;">

                        <form editable-form name="rowform" onbeforesave="saveDocumentProduit($data, documentProduit.id)"
                          ng-show="rowform.$visible" class="form-buttons form-inline float-right"
                          shown="DocumentProduitInserree == documentProduit">
                          <button type="submit" ng-disabled="rowform.$waiting" class="btn btn-sm" aria-hidden="true">
                            <i class="ms-Icon ms-Icon--Download" aria-hidden="true"></i>
                          </button>

                          <button type="button" ng-disabled="rowform.$waiting"
                            ng-click="cancelAddProduit(rowform, $index, documentProduit.id, documentProduit.typeDocumentId, listeDocumentProduit )"
                            class="btn btn-sm">
                            <i class="ms-Icon ms-Icon--Cancel" aria-hidden="true"></i>
                          </button>
                        </form>
                        <div class="buttons float-right" ng-show="!rowform.$visible">
                          <button data-nodrag class="btn btn-sm "
                            ng-click="rowform.$show()">
                          	<i class="ms-Icon ms-Icon--Edit" aria-hidden="true"></i>
                          </button>
                          <button data-nodrag class="btn btn-sm "
                            ng-click="removeDocumentProduit($index)">
                          	<i class="ms-Icon ms-Icon--Delete" aria-hidden="true"></i>
                          </button>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>


      </div>
    </div>








    <div ng-if="natureLivraison == 'FACON'" class="col-sm-12">

      <span class="ms-ListItem-primaryText">Traitements Fa&ccedil;on</span>
      <br />
      <div class="panel panel-primary">
        <div class="panel-body">
          <div class="form-group">
            <div class="row">

              <div ng-show="modeValider == 'actif'" class="panel panel-primary">
                <table class="table table-bordered table-hover table-condensed table-head-color">
                  <thead>
                    <tr style="font-weight: bold;">
                      <th>D&eacute;signation</th>
                      <th>R&eacute;f. Mise</th>
                      <th>Quantit&eacute;</th>
                      <th>Unité</th>
                      <th>Nbr.Colis</th>
                      <th>P.U.H.T</th>
                      <th>Remise</th>
                      <th>P.T.H.T</th>
                    </tr>
                  </thead>
                  <tr ng-repeat="detLivVente in listDetLivraisonVentePRBS">
                    <td>{{ detLivVente.designationTraitement || 'empty' }}</td>
                    <td>{{ detLivVente.refMiseList || 'empty' }}</td>
                    <td><input ng-model="detLivVente.quantite" /></td>
                    <td>{{ detLivVente.unite || 'empty' }}</td>
                    <td>{{ detLivVente.nombreColis || 'empty' }}</td>
                    <td>{{ detLivVente.prixUnitaireHT || 'empty' }}</td>
                    <td>
                      <input type="text" ng-model="detLivVente.pr"
                        ng-blur="detLivVente.remise = (detLivVente.pr*100)/detLivVente.prixUnitaireHT" />
                    </td>

                    <td>

                      <input type="text" class="form-control" ng-change="remiseChanged($index)"
                        ng-model="detLivVente.remise" placeholder="{{detLivVente.remise|number : 2}}" />
                    </td>
                    <td>{{ detLivVente.prixTotalHT | prixFiltre }}</td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>


  <div class="row" ng-show="displayMode != 'edit'">
    <div class="col-md-12">

      <span class="ms-ListItem-primaryText line">Liste de livraison</span>
      <br />
      <div style="height: 500px;" ng-grid="gridOptions"></div>
    </div>
  </div>


  <div id="light" class="white_content">
    <pop-up type="delete-bonVente"></pop-up>
  </div>
  <div id="fade" class="black_overlay"></div>
</div>